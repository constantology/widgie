!function(t,e,i){function s(t,e,i){var s,t=O.$(t);return t.length&&(s=t.attr("data-"+e),s&&(s=s.split("|"),~s.indexOf(i)||(i=s.join("|")+"|"+i)),t.attr("data-"+e,i)),I}function n(t){return V[t.id]||(V[t.id]=R.obj())}function a(t){if(i=t.getAttribute("data-cmp-id")||t.id,i&&(e=A.get(i)))return e;var e,i,s=t;do if(s.id&&(e=A.get(s.id)))return t.setAttribute("data-cmp-id",s.id),e;while(s=s.parentElement);return null}function r(t,e){_(t)&&(e=t,t=e.widgie||e.type),"string"!=typeof t&&(t="widgie.Component");var i=c(t)||I.Component;return i.create(e)}function o(e,i){return(_(e)||"function"==typeof e)&&(i=e,"function"==typeof i&&(i=i())),"string"!=typeof e&&(e=i.namespace||g(i.type),delete i.namespace),m(e,t.define(e,i))}function c(e){var i=t.get(e)||F[e];return i||(e=e.toLowerCase(),i=t.get("w."+e)||F[e],i||(e=e.replace(/\./g,"-"),i=t.get(e)||F[e])),i||null}function h(t){switch(t.type){case"blur":case"focus":if(t.target===B.activeElement&&t.target.getAttribute("tabindex")&&t.target!==t.currentTarget)return}v(t.currentTarget,t)}function l(t){Array.coerce(B.querySelectorAll("[data-"+t.type+"]")).forEach(function(e){v(e,t)})}function d(t){switch(typeof t){case"string":return c(t);case"function":return t.prototype instanceof c("data.Model")?t:null}return null}function u(t,e){switch(R.ntype(t)){case"object":t=t instanceof c("proxy.Ajax")?t:r(e||"proxy.Ajax",t);break;case"string":t=c(t);case"function":t=new t;break;default:t=null}return t||null}function p(t,e){switch(R.ntype(t)){case"array":t={properties:t};case"object":t=t instanceof c("data.Schema")?t:r(e||"data.Schema",t);break;case"string":t=c(t);case"function":t=new t;break;default:t=null}return t||null}function f(t){switch(typeof t){case"string":return c(t);case"function":return t instanceof c("data.Store")?t:null}return null}function m(t,e){var i,s=t.indexOf("widgie");return(0===s||1===s)&&(i=t.split(".").slice(1).join(".")),"string"==typeof i&&(F[i.toLowerCase().split(".").join("-")]=F[i]=e),e}function b(t,e,i){var s,n,t=O.$(t);return t.length&&(n=t.attr("data-"+e).split("|"),n.length&&(~(s=n.indexOf(i))&&n.splice(s,1),t.attr("data-"+e,n.length?n.join("|"):null))),I}function v(i,s){(i===B||i===k)&&(i=B.body);var n=i.getAttribute("data-"+s.type);"string"==typeof n&&n.split("|").forEach(function(n){var r;switch(n=n.split("::"),n.length){case 1:n=n.shift();break;case 2:return r=A.get(n.shift()),n=n.shift(),!t.is(r,e+".Component")||r.onAction(n,s),void 0}!(r=a(i))||r.onAction(n,s)})}function y(t){return delete V[t.id]}function g(t){return t=String(t),t.charAt(0).toUpperCase()+t.substring(1)}function x(t){return R.ntype(t)=="date"}function w(t){return R.type(t)=="htmlelement"}function _(t){return R.ntype(t)=="object"}function C(t){return"number"==typeof t&&!isNaN(t)}function T(t){return t===!0}function S(t){return"^"+e+"."+t}function E(e){if("type"in Object(e)&&(R.has(E.code,e.type)&&(e.name=E.code[e.type]),delete e.type),e=t(S("Error"),e),I.debug)throw e;return console.log(e),e}var $,A,L,j,D=e.toLowerCase(),R=t.util,I=R.obj(),O=R.obj(),k=R.global,B=k.document,V=R.obj(),F=R.obj();O.$=dinero,O.date={coerce:function(t,e){return Date.coerce(t,e)},format:function(t,e){return t.format(e)}},O.tpl={create:function(t){return t instanceof Templ8?t:Templ8.get(t)||new Templ8(t)},get:function(t){return O.tpl.create(t)},parse:function(t,e){return t.parse(e)}},O.ua=j=dinero.ua,O.xhr=function(){function t(t){return t.removeEventListener("error",t._onerror,!0),t.removeEventListener("load",t._onload,!0),delete t._onerror,delete t._onload,delete t._config,t}function e(t){var e=((t.getResponseHeader("Content-Type")||"").split("/")[1]||"").split(";")[0],i=t.responseText.trim().replace(/^[\n\r\s\t]+/m,"");switch(t.responseType||e){case"json":case"javascript":return _(t.response)?t.response:i.indexOf("<")!==0?JSON.parse(i):null;case"arraybuffer":case"blob":case"document":return t.response;case"html":case"xml":return typeof t.response=="string"?t.responseXML:t.response;case"text":case"":return t.responseText}return a(t)}function i(){var i=this,s=i._config;typeof s.error!="function"||s.error(e(i),i.status,t(i),s)}function s(){var i=this,s=i._config;typeof s.success!="function"||s.success(e(i),i.status,t(i),s)}function n(t,e,i){return t.setRequestHeader(i,e),t}function a(t){try{return JSON.parse(t.responseText)}catch(e){return t.responseXML||t.responseText}}var r=/DELETE|POST|PUT/i,o={Accept:"*/*;q=0.5,application/json,application/javascript,text/javascript,application/ecmascript,application/x-ecmascript","Content-Type":"application/json;charset=UTF-8","X-Requested-With":"XMLHttpRequest"};return function(t){var e,a,c,h=new XMLHttpRequest;switch(h._config=t,e=t.data,t.headers=a=R.copy(t.headers||R.obj(),o,!0),c=t.method,c=c?c.toUpperCase():"GET",h.addEventListener("error",h._onerror=i.bind(h),!0),h.addEventListener("load",h._onload=s.bind(h),!0),h.open(c,t.url,!0),r.test(c)&&a["Content-Type"]===o["Content-Type"]&&t.sendJSON!==!0&&(a["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8"),!h.overrideMimeType||h.overrideMimeType(a["Content-Type"]),Object.reduce(t.headers,n,h),R.ntype(e)){case"string":case"formdata":break;case"array":case"object":e=t.sendJSON===!0?JSON.stringify(e):I.qs.encode(e).substring(1);break;default:e=null}return h.send(e),h}}(),!function(){var t={compiled:!0,execute:function(t,e){return typeof t[e]=="function"?t[e].apply(t,Array.coerce(arguments,2)):""},prepare:function(t){return t.prepare(t.data?t.data:null)},sort:function(t,e){return t.values.map(function(t){return[t[e],t]}).sort(function(t,e){return t[0]==e[0]?0:t[0]<e[0]?1:-1}).map(function(t){return t[1]})},toJSON:function(t){return t.valueOf()}};new Templ8(m8.copy({id:"widgie.box",sourceURL:"tpl/box.html"},t),'<{{ @.tagName }} class="{{ @.clsBase }} {{ @.clsDefault if @.clsDefault|exists }} {{ @.cls if @.cls|exists }}"{% if this.focusable !== false %} tabindex="-1"{% endif %}>','	<div class="{{ @.clsBase }}-ct" data-ref="ct"></div>',"</{{ @.tagName }}>"),new Templ8(m8.copy({id:"widgie.component",sourceURL:"tpl/component.html"},t),'<{{ @.tagName }} class="{{ @.clsBase }} {{ @.clsDefault if @.clsDefault|exists }} {{ @.cls if @.cls|exists }}"{% if this.focusable !== false %} tabindex="-1"{% endif %}><div class="{{ @.clsBase }}-ct" data-ref="ct">','	{{ @.html if @.html|type:"string" }}',"	{% if @.tplContent|exists AND @.data|exists %}{{ @|prepare:@.data|parse:@.tplContent }}{% endif %}","</div></{{ @.tagName }}>"),new Templ8(m8.copy({id:"widgie.field",sourceURL:"tpl/field.html"},t),"{% sub label %}",'<label class="{{ clsBase }}-label" data-ref="label" for="{{ id }}-input">{{ label }}</label>',"{% endsub %}","{% sub placeholder %}","placeholder=\"{% if placeholder === ':label' %}{{ label }}{% else %}{{ placeholder }}{% endif %}\"","{% endsub %}",'<{{ @.tagName }} class="{{ @.clsBase }} {{ @.clsDefault if @.clsDefault|exists }} {{ @.cls if @.cls|exists }} {{ @.clsBase }}-{{ @.inputType }}"{% if @.errorMsg %} data-error-msg="{{ @.errorMsg }}"{% endif %} tabindex="-1"><div class="{{ @.clsBase }}-ct" data-ref="ct"{% if @.toolTip %} data-tool-tip="{{ @.toolTip }}"{% endif %}>',"	{% if @.showLabel AND @.labelPosition !== 'after' %}{{ @|parse:\"label\" }}{% endif %}","	<span class=\"{{ @.clsBase }}-input-ct {{ @.clsBase }}-input-{{ @.inputType }}-ct\">{% if @.inputType === 'text' AND @.multiLine === true %}",'		<textarea autocapitalize="off" autocorrect="off" class="{{ @.clsBase }}-input {{ @.clsBase }}-input-multiline {{ @.clsBase }}-input-{{ @.inputType }}" data-ref="field" id="{{ @.id }}-input" name="{{ @.name }}" {{ @|parse:"placeholder" if @.placeholder|type:"string" }}></textarea>',"	{% else %}",'		<input autocapitalize="off" autocorrect="off" class="{{ @.clsBase }}-input {{ @.clsBase }}-input-{{ @.inputType }}" data-ref="field" id="{{ @.id }}-input" name="{{ @.name }}" {{ @|parse:"placeholder" if @.placeholder|type:"string" }} type="{{ @._inputType }}" value="{{ @.value if @.value|exists }}" />',"	{% endif %}</span>","	{% if @.showLabel AND @.labelPosition === 'after' %}{{ @|parse:\"label\" }}{% endif %}","</div></{{ @.tagName }}>")}(),R.iter(i)||(i=R.ENV=="commonjs"?module:k),R.defs(I=R.expose(I,e,i),{api:{value:O},gestureEnabled:j.touch,ua:{value:j},addDOMListener:s,closest:a,create:r,define:o,error:E,doc:B,getClass:c,global:k,lib:t,removeDOMListener:b,takeAction:v,util:R},"r"),R.expose(t,I),R.expose(R,I),L=t.Class({constructor:function(){this._decode_=this._decode.bind(this),this._encode_=this._encode.bind(this)},extend:Object,decode:function(t){t=t.indexOf("?")===0?t.substring(1):t;var e=R.obj();return t.length?t.split("&").reduce(this._decode_,e):e},encode:function(t){return"?"+Object.reduce(t,this._encode_,"").substring(1)},_decode:function(t,e){e=e.split("=");var i=decodeURI(e.shift()),s=decodeURI(e.shift());return i in t?(Array.isArray(t[i])||(t[i]=[t[i]]),t[i].push(s)):t[i]=s,t},_encode:function(t,e,i){switch(i="&"+encodeURI(i)+"=",R.ntype(e)){case"array":t+=i+e.map(encodeURI).join(i);break;case"date":e=+e;case"boolean":case"number":case"string":t+=i+encodeURI(e)}return t}}),R.def(I,"qs",{value:new L},"cw"),t.define(S("Gesture"),function(){function e(t){this.gesture=t,this.tolerance=t.tolerance}function i(t,e,i){return t>=e&&i>=t}function s(){!l||l.cancel()}function n(t){if(l)l.end(t);else{var e,i=O.$(t.target).closest(m)[0];if(!i)return;if(e=c[R.id(i)],!e||!e.interactive||!e.valid(t.target))return;e.end(t)}l=null}function a(t){!l||l.move(t)}function r(t){var e,i=O.$(t.target).closest(m)[0];i&&(e=c[R.id(i)],e&&e.interactive&&e.valid(t.target)&&(!l||l.cancel(),l=e.start(t)))}k.addEventListener("beforeunload",function(){k.removeEventListener("scroll",h,!0),k.removeEventListener(j.mspoint?"MSPointerUp":"touchend",n,!0),k.removeEventListener(j.mspoint?"MSPointerMove":"touchmove",a,!0),k.removeEventListener(j.mspoint?"MSPointerDown":"touchstart",r,!0)},!0);var o="data-gesture-hotspot",c=R.obj(),h=s.callback({buffer:100,delay:100}),l=null,d=k.document,u={x:{backward:"left",diff:"diffX",dir:"directionX",forward:"right",id:"x",last:"lastX",page:"pageX",start:"startX"},y:{backward:"up",diff:"diffY",dir:"directionY",forward:"down",id:"y",last:"lastY",page:"pageY",start:"startY"}},p="initialRotation initialScale pressure rotation scale touches".split(" "),f=180/Math.PI,m="["+o+'="true"]';return k.addEventListener("scroll",h,!0),k.addEventListener(j.mspoint?"MSPointerUp":"touchend",n,!0),k.addEventListener(j.mspoint?"MSPointerMove":"touchmove",a,!0),k.addEventListener(j.mspoint?"MSPointerDown":"touchstart",r,!0),e.prototype={constructor:e,angle:-1,diffX:null,diffY:null,directionX:null,directionY:null,gesture:null,lastX:null,lastY:null,startX:null,startY:null,tolerance:null,type:null,x:null,y:null,end:function(){var t=Math.abs(C(this.x)?this.startX-this.x:this.lastX-this.startX),e=Math.abs(C(this.y)?this.startY-this.y:this.lastY-this.startY),s=Math.round(Math.atan2(e,t)*f),n="";n+=i(s,0,this.tolerance)?this.directionX||"":i(s,60,60+this.tolerance)?this.directionY||"":(this.directionX||"")+(this.directionY||""),this.angle=s,this.type=n},process:function(t){this.setCoord("x",t),this.setCoord("y",t)},setCoord:function(t,e){var i,s=u[t],n=s.diff,a=s.dir,r=s.last,o=s.start;C(this[t])?(this[r]=this[t],this[t]=e[s.page],i=this[n]=this[t]-this[r],this[a]=0>i?s.backward:i>0?s.forward:null):this[t]=this[o]=e[s.page]}},{constructor:function(t){this.increasePressure_=this.increasePressure.bind(this),this.mixin("observer",_(t)?t.observers:[]).parent(arguments)},extend:t.Source,mixins:{observer:"Observer"},module:I,active:!1,destroyed:!1,disabled:!1,exclusions:null,initialRotation:null,initialScale:null,interactive:{get:function(){return!this.destroyed&&!this.disabled},set:function(){return this.interactive}},longtapDelay:700,rotation:null,precision:.17,pressInterval:100,pressure:null,scale:null,tapDelay:200,tolerance:15,touches:null,id_dbltap:null,id_lngtap:null,is_dbltap:!1,is_lngtap:!1,ts_tap:null,cancel:function(){this.active&&(this.active=!1,this.reset().broadcast("cancel"))},end:function(t){this.interactive&&this.active&&this.broadcast("before:end",t)!==!1&&(this.process(t),this.active=!1,this.ts_tap?this.id_dbltap=setTimeout(this.onEnd.bind(this,t),this.tapDelay):this.onEnd(t))},enable:function(){this.disabled&&this.broadcast("before:enable")!==!1&&(this.disabled=!1,this.broadcast("enable"))},disable:function(){this.disabled||this.broadcast("before:disable")===!1||(this.disabled=!0,this.broadcast("disable"))},increasePressure:function(){this.pressure+=1,this.ts_tap&&Date.now()-this.ts_tap>=this.longtapDelay&&(this.is_lngtap=!0)},move:function(t){if(this.active&&this.interactive){this.process(t);var e=this.tolerance*2;this.diffX<e&&this.diffY<e||this.broadcast("move",t)}},reset:function(){this.cleanup(),!this.active&&this.interactive&&(R.remove(this,p),this.broadcast("reset"))},start:function(t){this.interactive&&!this.active&&this.broadcast("before:start",t)!==!1&&(this.id_dbltap&&i(Date.now()-this.ts_tap,0,this.tapDelay)&&(this.cleanup().is_dbltap=this.active=!0),this.is_dbltap!==!0&&this.is_lngtap!==!0&&(this.reset(),this.active=!0,this.initialRotation=t.rotation,this.initialScale=t.scale,this.pressure=0,this.touches=[],this.id_lngtap=setInterval(this.increasePressure_,this.pressInterval),this.ts_tap=Date.now(),this.process(t).broadcast("start",t)))},valid:function(t){return this.exclusions===null||!O.$(t).closest(this.exclusions).length},cancelPress:function(){k.clearInterval(this.id_lngtap),delete this.id_lngtap},cancelTap:function(){k.clearTimeout(this.id_dbltap),delete this.id_dbltap},cleanup:function(){R.remove(this.cancelPress().cancelTap(),"is_dbltap","is_lngtap","ts_tap")},init:function(){this.parent(arguments),typeof this.el=="string"&&(this.el=d.querySelector(this.el)||d.getElementById(this.el)||null),w(this.el)&&(c[R.id(this.el)]=this,this.el.setAttribute(o,"true")),Array.isArray(this.exlusions)&&(this.exclusions=this.exclusions.join(", ")),this.observe({move:this.cleanup,ctx:this})},onDestroy:function(){delete c[R.id(this.el)],this.parent(arguments)},onEnd:function(t){!Array.isArray(this.touches)||this.touches.invoke("end");var e=this.resolve(t);this.cleanup().broadcast(e,t).broadcast("end",t)},process:function(t){var e=Array.coerce(t.touches,0,2);this.rotation=t.rotation,this.scale=t.scale,e.length&&this.touches.length<=e.length&&e.forEach(this.processTouch,this)},processTouch:function(t,i){this.touches[i]||(this.touches[i]=new e(this)),this.touches[i].process(t)},resolve:function(){var t=this.touches;switch(t.length){case 2:if(i(this.rotation,-300,-60)||i(this.rotation,60,300))return"rotate";if(Math.abs(Math.abs(this.initialScale)-Math.abs(this.scale))>this.precision)return this.initialScale>this.scale?"pinch":"zoom";default:return this.is_dbltap===!0?"doubletap":this.is_lngtap===!0?"longtap":!t[0].type&&Date.now()-this.ts_tap>=this.tapDelay?"tap":"swipe"+t[0].type}}}}()),t.define(S("TypedHash"),function(){return{constructor:function(e){var i;_(e)||(e={}),R.got(e,"Type","data","propId")?(this.Type=typeof e.Type=="function"?e.Type:t.get(e.Type)||Object,this.propId=e.propId||"id",i=e.data):R.empty(e)||(i=e),this.parent(i)},extend:"Hash",module:I,propId:"id",Type:null,add:function(t){var e=t instanceof this.Type?t:this.Type.create.apply(this.Type,arguments);return this.set(e[this.propId]||R.id(e),e),e},get:function(t){return R.exists(t)?("string"!=typeof t&&(t=t[this.propId]),this.parent(t)):null},has:function(t){return"string"!=typeof t&&(t=t[this.propId]),this.parent(t)},include:function(t){return this.has(t)?!1:this.add(t)},set:function(t,e){_(t)&&t.constructor===Object?this.parent(t):e instanceof this.Type&&this.parent(t,e)}}}()),R.def(I,"Validate",{value:{checkbox:{minmax:function(){return!0},raw:function(t,e){return e},val:function(t,e){return e},valid:function(t){return!t.elField||t.elField.checked===!0}},date:{minmax:function(t,e){return e<=t.max&&e>=t.min},raw:function(t,e){return e},val:function(t,e){return e},valid:function(t,e){return R.ntype(e)=="date"&&e<=t.max&&e>=t.min}},file:{minmax:function(){return!0},raw:function(t){return t.elField.files[0]},val:function(t){return t.elField.files[0]},valid:function(){return!0}},number:{minmax:function(t,e){return e<=t.max&&e>=t.min},raw:function(){},val:function(){},valid:function(t,e){return R.type(e)=="number"&&(t.allowDecimals||Math.floor(e)===e)}},text:{minmax:function(t,e){return e.length<=t.max&&e.length>=t.min},raw:function(t,e){return e},val:function(t,e){return e},valid:function(t,e){return"string"==typeof e&&(!t.pattern||t.pattern.test(e))}}}},"cw"),I.Validate.radio=I.Validate.checkbox,I.Validate.email=I.Validate.hidden=I.Validate.number=I.Validate.password=I.Validate.text,o(S("proxy.Ajax"),function(){function e(t,e){this.loading=!1,!this.interactive||"abort"==status||this.onReqAbort(t,e.options).broadcast("abort",err,e.options)}function i(t,e,i,s){this.loading=!1,!this.interactive||this.onReqError(t,e,i,s.options).broadcast("error",i,e,t,s.options)}function s(t,e,i,s){this.loading=!1,!this.interactive||"object"!=typeof t||this.onReqLoad(t,e,i,s.options).broadcast("load",t,e,i,s.options)}function n(){this.loading=!1,this.abort().onReqTimeout(this.current).broadcast("timeout",this.current)}return{constructor:function(t){this.mixin("observer",_(t)?t.observers:[]).parent(arguments)},extend:t.Source,mixins:{observer:"Observer"},module:I,defaultData:null,headers:null,method:"get",timeout:3e4,urlBase:null,interactive:{get:function(){return!this.disabled},set:function(){return this.interactive}},loading:!1,lastConfig:null,tid:null,abort:function(){!this.current||this.current.abort()},disable:function(){this.disabled||this.broadcast("before:disable")===!1||(this.disabled=!0,this.onDisable().broadcast("disable"))},enable:function(){this.disabled&&this.broadcast("before:enable")!==!1&&(this.disabled=!1,this.onEnable().broadcast("enable"))},load:function(t,e,i){_(e)&&(i=e,e=$),e&&"string"==typeof e||(e=this.method||"GET"),e=e.toUpperCase(),this.interactive&&this.broadcast("before:load",t,e,i)!==!1&&this.onLoadStart(this.createUrl(t=this.prepareData(t)),e,t,i)},reload:function(){this.lastConfig&&this.interactive&&this.broadcast("before:reload")!==!1&&this.doRequest(this.lastConfig)},onReqAbort:function(){},onReqError:function(){},onReqLoad:function(){},onReqTimeout:function(){},createUrl:function(){return this.urlBase},doRequest:function(t){return this.lastConfig=t,this.loading=!0,this.current=O.xhr(t),this.tid=setTimeout(this.onTimeout,this.timeout),this.broadcast("loadstart"),this.current},initTransport:function(t,e,i,s){var n={abort:this.onAbort,error:this.onError,headers:this.headers,method:e||this.method,options:s||R.obj(),success:this.onLoad,url:t};return("POST"===e||"PUT"===e)&&(n.data=i),n},prepareData:function(t){return R.copy(t||R.obj(),this.defaultData,!0)},removeTransport:function(){!this.current||delete this.current,clearTimeout(this.tid),delete this.tid},onBeforeLoad:function(){!this.current||this.abort(!0)},onDisable:function(){},onEnable:function(){},onLoadStart:function(){return this.doRequest(this.initTransport.apply(this,arguments))},init:function(){this.onAbort=e.bind(this),this.onError=i.bind(this),this.onLoad=s.bind(this),this.onTimeout=n.bind(this),_(this.defaultData)||(this.defaultData=R.obj());var t=[this.onBeforeLoad,this.removeTransport];this.observe({abort:this.removeTransport,"before:load":t,"before:reload":t,error:this.removeTransport,load:this.removeTransport,timeout:this.removeTransport,ctx:this})}}}()),R.def(I.proxy,"lookup",u,"r"),o(S("proxy.CRUD"),function(){function t(t){return function(e,i){return this.onAPICall(t,e,i)}}var e={create:{method:"POST",url:"create"},"delete":{method:"POST",url:"delete"},read:{method:"GET",url:"get"},update:{method:"POST",url:"update"}};return{extend:S("proxy.Ajax"),module:I,api:null,create:t("create"),"delete":t("delete"),read:t("read"),update:t("update"),createUrl:function(t,e){return e.url||this.urlBase},onAPICall:function(t,e,i){t=t in this.api?t:"read";var s=this.api[t];_(i)||(i=R.obj()),i.command=t,s&&this.interactive&&this.broadcast("before:"+t,e,i)!==!1&&this.onLoadStart(this.createUrl(e,s),s.method,e=this.prepareData(e,s),i)},onReqAbort:function(t,e){this.broadcast("abort:"+e.command,t,err,e)},onReqError:function(t,e,i,s){this.broadcast("error:"+s.command,t,e,i,s)},onReqLoad:function(t,e,i,s){this.broadcast(s.command,t,e,i,s)},prepareData:function(t,e){return typeof e.data=="function"?e.data(t):t},init:function(){this.parent(arguments).initAPI()},initAPI:function(){_(this.api)||(this.api=R.obj()),Object.reduce(this.api,this.initAPIMethod,this)},initAPIMethod:function(i,s,n){var a=e[n];return"string"==typeof s&&(s={url:s}),typeof i.urlBase=="string"&&typeof s.url=="string"&&(s.url=i.urlBase+(s.url.indexOf("/")===0?"":"/")+s.url),i.api[n]=R.update(s,a),typeof i[n]!="function"&&(i[n]=t(n)),i}}}()),o(S("proxy.ModelSync"),function(){return{extend:S("proxy.CRUD"),module:I,api:null,create:function(t,e){var i=e.model.schema.mappings.id;delete t[i],this.parent(t,e)},"delete":function(t){t.exists&&this.parent({id:t.id},{model:t})},read:function(t,e){var i=e.model.schema.mappings.id;this.parent({id:t[i]||e.model[i]},e)},sync:function(t,e){var i="read";t.dirty?i=t.exists?"update":"create":t.exists||(i="create"),_(e)||(e=R.obj()),e.model=t,!(i in this.api)||this[i](t.toJSON(),e)},onReqAbort:function(t,e){this.parent(arguments),e.model.onSyncAbort(e.command)},onReqError:function(t,e,i,s){this.parent(arguments),s.model.onSyncError(i,s.command)},onReqLoad:function(t,e,i,s){this.parent(arguments),s.model.onSync(t,s.command)},onBeforeLoad:function(){}}}()),o(S("data.Model"),function(){function t(t,e){return e.attr("data-model-id",t.id),Object.keys(t.changes).forEach(function(t){e.find('[data-model-binding="'+t+'"]').html(this[t])},t.src),t}function e(t,e,i){var s=this.schema.property[i];return s&&s.stringify!==!1&&(t[i]=s.store?e.toJSON():R.merge(e)),t}var i=999;return{afterdefine:function(t){var e=t.prototype;(t.__proxy__=u(e.proxy,"proxy.ModelSync"))&&delete e.proxy,(t.__schema__=p(e.schema))&&delete e.schema},beforeinstance:function(t,e){e.proxy=t.__proxy__,e.schema=t.__schema__},constructor:function(t){this.parent(),this.changes=R.obj(),this.dom=R.obj(),this.raw=t||R.obj(),this.src=t?this.schema.coerceItem(t):R.obj();var e=this.schema,s=this.src[e.mappings.id]||this.raw[e.mappings.id];this.exists=!!s,this.id=s||"phantom-"+ ++i,this.exists?(R.len(t)-1||this.autoLoad===!1||this.sync(),this.set("id",s)):R.len(this.src)>0&&this.autoSync===!0&&this.sync()},extend:"Observer",module:I,proxy:null,schema:null,autoLoad:!0,autoSync:!1,dirty:{get:function(){return!!R.len(this.changes)},set:function(){return this.dirty}},deleted:!1,syncing:!1,changes:null,id:null,dom:null,exists:!1,raw:null,slc:null,src:null,strict:!1,suspendChange:0,suspendSync:0,destroy:function(t){this.autoSync===!0?(t===!0&&this.parent(arguments),this.proxy.delete(this)):this.deleted=!0},get:function(t){return this.src[t]===$?null:this.src[t]},getBoundEl:function(t){return this.dom["string"==typeof t?t:t.id]||null},revert:function(t){return"string"!=typeof t?(Object.keys(this.changes).forEach(this.revert,this),void 0):(t in this.changes&&(this.set(t,this.changes[t]),delete this.changes[t]),void 0)},set:function(t,e,i){return _(t)?("boolean"==typeof e&&(i=e),this.suspendChange||++this.suspendChange,Object.reduce(t,function(t,e,i){return t.onSet(i,e,!0)},this),!this.suspendChange||--this.suspendChange,i===!0||this.syncView(),this.broadcast("change"),void 0):(this.onSet(t,e,i),i===!0||this.syncView(),!this.dirty||this.autoSync===!1||this.sync(),void 0)},sync:function(){this.suspendSync||(this.syncing=!0,this.proxy.sync(this))},toJSON:function(){var t=R.obj();return this.destroyed||this.deleted?(t.deleted=!0,t):(t.syncing=this.syncing,Object.reduce(this.src,e.bind(this),t),this.exists?t.id=this.id:delete t.id,t)},bindView:function(t,e){switch(R.type(e)){case"element[]":break;case"htmlelement":e=O.$(e);break;default:if(!(e=t.$el.find(this.slc)).size)return}this.dom[t.id]=e.attr("data-model-id",this.id)},onDestroy:function(){this.parent(arguments),this.destroyed=!0,delete this.changes,delete this.dom,delete this.exists,delete this.id,delete this.raw,delete this.src},onSet:function(t,e){var i,s=this.schema,n=s.property;t in n&&(n[t].store?(this.src[t].load(e),this.suspendChange||n[t].track===!1||this.broadcast("change"),n[t].track===!1||this.broadcast("change:"+t)):(i=n[t].coerce(e),i!==this.src[t]&&(this.raw[t]=e,this.changes[t]=this.src[t],this.src[t]=i,this.suspendChange||n[t].track===!1||this.broadcast("change"),n[t].track===!1||this.broadcast("change:"+t,this.src[t],this.changes[t])))),t===s.mappings.id&&(this.id=this.src[t]||e,this.slc='[data-id="'+this.id+'"], [data-model-id="'+this.id+'"]')},onSync:function(t,e){if(this.syncing=!1,t){if(R.remove(this.dom,Object.keys(this.dom)),"delete"===e)return this.destroy(!0);var i=this.schema.getItemRoot(t);i&&(R.copy(this.src,this.schema.coerceItem(i)),this.raw=i,"create"===e&&(this.id=this.src.id,this.exists=!!this.id),"read"===e&&R.remove(this.changes,Object.keys(this.changes)),this.broadcast("sync",e,t).broadcast("change"))}},onSyncAbort:function(t){this.syncing=!1,this.broadcast("sync:abort",t)},onSyncError:function(t,e){this.syncing=!1,this.broadcast("sync:error",e,t)},syncView:function(){Object.reduce(this.dom,t,this)}}}()),!function(){function t(t,e){return t[e.id]=e,t}function e(t){return t instanceof i.Property?t:widgie.create("data.Schema.Property",t)}o(S("data.Schema"),{afterdefine:function(t){var e=t.prototype;t.__mappings__=e.mappings,t.__properties__=e.properties,delete e.mappings,delete e.properties},beforeinstance:function(t,e,i){var s=_(i[0]);_(t.__mappings__)&&(e.mappings=s?R.update(i[0].mappings||R.obj(),t.__mappings__):R.update(t.__mappings__),!s||delete i[0].mappings),typeof t.__properties__=="object"&&(e.properties=s?R.update(i[0].properties||R.obj(),t.__properties__):R.update(t.__properties__),!s||delete i[0].properties)},constructor:function(i){Array.isArray(i)&&(i={properties:i}),_(i)||(i=R.obj()),this.mappings=R.update(i.mappings||this.mappings||R.obj(),s),this.properties=(i.properties||this.properties).map(e,this),this.property=this.properties.reduce(t,R.obj())},extend:Object,module:I,mappings:null,properties:null,property:null,coerce:function(t){var e=this.prepare(t);return e.items=e.items.map(this.coerceItem,this),e},coerceItem:function(t){var e=R.obj();return this.properties.invoke("process",R.update(this.getItemRoot(t)),e),e},getItemRoot:function(t){var e=this.mappings.item;return e?Object.value(t,e)||t:t},getRoot:function(t){if(!t)return[];var e=this.mappings.items,i=Array.isArray(t)?t:e?Object.value(t,e)||t:t;return Array.isArray(i)?i.slice():[]},prepare:function(t){var e,i,s;return t&&"object"==typeof t?(e=this.getRoot(t),s=this.mappings.total in t?t[this.mappings.total]:e.length,i=this.mappings.success in t?t[this.mappings.success]:!!s):(e=[],s=-1,i=!1),{items:e,success:i,total:s}},valid:function(t){return Object.keys(t).every(function(e){return e in this&&this[e].valid(t[e])},this.property)}}),o(S("data.Schema.Property"),{constructor:function(t){switch(R.copy(this,t||{}),!this.cite&&this.id&&(this.cite=this.id),!this.id&&this.cite&&(this.id=this.cite),~this.id.indexOf(".")?(this.path=this.id.split("."),this._id=this.path.pop(),this.path=this.path.join(".")):(this._id=this.id,this.path=""),typeof this.type){case"function":break;case"string":this.default===null&&this.type!=="object"&&(this.default=n[this.type]),this.type=r[this.type]}switch(typeof this.type=="function"||E({instance:this,method:"constructor",message:"Invalid data.Schema.Property#type",name:E.code.DATA_SCHEMA_TYPE}),typeof this.format){case"function":case"string":break;default:this.format=R}this.fmt=a[R.ntype(this.format)]||this.fmt,this.schema=p(this.schema),this.type.id=="collection"&&(this.store=f(this.store))},extend:Object,module:I,cite:null,"default":null,format:null,id:null,schema:null,store:null,track:!0,type:"object",_id:null,coerce:function(t,e,i){return this.fmt(t,this.format,e,i)},process:function(t,e){return this.assign(this.coerce(this.val(t,e),t,e),e)},valid:function(t){return this.store?!0:R.ntype(t)===this.type.id},value:R,assign:function(t,e){var i=R.bless(this.path,e);return i[this._id]=t,e},fmt:R,val:function(t,e){var i=this.value(Object.value(t,this.cite)||null,t,e);return i===this||i===$?null:i}});var i=c("data.Schema"),s=i.DEFAULT_MAPPINGS={id:"id",items:"items",success:"success",total:"total"},n={"boolean":!1,date:"now",number:0,string:""},a={"function":function(t,e,i,s){return e.call(this,this.type(t),i,s)},string:function(t,e){return this.type(t,e)}},r=i.TYPE={array:function(t){return this.schema?this.schema.coerce(t).items||[]:Array.isArray(t)?t:R.exists(t)?Array.coerce(t):[]},"boolean":function(t){return"boolean"==typeof t?t:"false"==t?!1:typeof this.default=="boolean"?this.default:Boolean.coerce(t)},collection:function(t){return this.store.create({data:t})},date:function(t,e){if(x(t))return t;var i;if(e||(e=this.format),null!==t)switch(typeof e){case"string":i=O.date.coerce(t,e);break;case"function":i=e(t);break;default:i=new Date(t)}else i=0/0;return isNaN(+i)?this.default=="now"?new Date:new Date(+this.default):i},number:function(t){return Number(t)==t?Number(t):this.default},object:function(t){return this.schema?this.schema.coerceItem(t):t===$?this.default:t},string:function(t){return String(t)==t?String(t).trim():this.default}};Object.keys(r).forEach(function(t){this[t].id=t},r)}(),o(S("data.Collection"),function(){function e(t){this.set(t.id,t)}function i(t,e){return t.view.ovalues.map(function(t){return[t.get(e),t]})}var s={date:function(t,e,i){return+i.get(t)===+e},"default":function(t,e,i){return i.get(t)===e},regexp:function(t,e,i){return e.test(i.get(t))},string:function(t,e,i){return String(i.get(t)).toLowerCase()===e}},n={asc:function(t,e){return t[0]===e[0]?0:t[0]>e[0]?1:-1},desc:function(t,e){return t[0]===e[0]?0:t[0]<e[0]?1:-1}};return{constructor:function(t){this.mixin("observer",_(t)?t.observers:[]).parent(arguments)},extend:t.Source,mixins:{observer:"Observer"},module:I,data:null,id:null,model:null,proxy:null,schema:null,changes:{get:function(){return this.data.reduce(function(t,e){return!e.dirty||t.push(e),t},[])},set:function(){return this.changes}},dirty:{get:function(){return this.data.values.pluck("dirty").some(T)},set:function(){return this.dirty}},size:{get:function(){return this.data.length},set:function(){return this.size}},view:{get:function(){return this.current||this.data},set:function(){return this.view}},loading:!1,current:null,stache:null,suspendChange:0,add:function(t,e){if(t){if(Array.isArray(t)){if(!t.length)return;return this.suspendChange||++this.suspendChange,t.forEach(this.add,this),!this.suspendChange||--this.suspendChange,this.onChangeData(e)}var i=this.onAdd(t);!i||this.broadcast("add",i).onChangeData(e)}},bindView:function(t){this.data.values.invoke("bindView",t)},byId:function(t){return _(t)?t instanceof this.model&&this.data.key(t)?t:this.data.get(t[this.model.__schema__.mappings.id])||this.data.get(t.id):this.data.get(t)||null},clear:function(t){this.data.clear(),t===!0||this.broadcast("clear"),this.onChangeData(t)},clearFilters:function(t){this.emptyStash(t)},commit:function(){},contains:function(t){return!!this.byId(t)},each:function(t,e){this.view.ovalues.forEach(t,e||this)},emptyStash:function(t){delete this.current,this.stache.length=0,t===!0||this.broadcast("empty:stash"),this.onChangeView(t)},fetch:function(t,e){this.proxy&&(this.proxy.load(this.prepare(t),e),this.loading=this.proxy.loading)},filter:function(t,e){e||(e=this),this.updateView(this.view.ovalues.filter(function(i,s){return t.call(e,i,s,this)},this))},filterBy:function(t,e){this.filter((s[R.ntype(e)]||s.default).bind(this,t,e))},find:function(t,e){return e||(e=this),this.data.ovalues.find(function(i,s){return t.call(e,i,s,this)},this)},findAll:function(t,e){return e||(e=this),this.data.ovalues.filter(function(i,s){return t.call(e,i,s,this)
},this)},first:function(){return this.getAt(0)},get:function(t){return _(t)?t instanceof this.model&&this.data.key(t)?t:this.data.get(t[this.model.__schema__.mappings.id])||this.data.get(t.id):this.byId(t)||this.getAt(t)||null},getAt:function(t){return this.data.ovalues[t>-1?t:this.data.length+t]||null},getBoundEls:function(t){return this.data.values.invoke("getBoundEl",t)},indexOf:function(t,e){return t=this.get(t),t?(e===!0?this.view:this.data).ovalues.indexOf(t):-1},last:function(){return this.getAt(-1)},load:function(t,e){var i=this.readResponse(t);i.success&&i.items?(this.clearFilters(!0).add(i.items,!!e),!e||this.onChangeData(!1,e)):this.broadcast("load:empty",i,e)},map:function(t,e){return this.view.ovalues.map(t,e||this)},next:function(t){var e=this.indexOf(t,!0);return~e?this.view.ovalues[e+1]||null:null},pluck:function(t){return this.view.values.invoke("get",t)},prev:function(t){var e=this.indexOf(t,!0);return~e?this.view.ovalues[e-1]||null:null},reduce:function(t,e,i){return i||(i=this),this.view.ovalues.reduce(function(e,s){return t.call(i,e,s)},e)},remove:function(t,e){t=this.get(t),t&&this.onRemove(t)&&(this.broadcast("remove",t),e===!0||this.onChangeData(e))},readResponse:function(t){return this.model.__schema__.prepare(t)},revert:function(t,e){return t?(t=this.get(t),t.dirty&&(t.revert(),e===!0||this.broadcast("revert",t).onChangeData()),void 0):("boolean"==typeof t&&(e=t),t=this.changes,t.length&&(t.invoke("revert"),e===!0||this.broadcast("revert",t).onChangeData()),void 0)},setModel:function(t){(this.model=d(t))&&this.broadcast("set:model")},setProxy:function(t){this.proxy instanceof c("proxy.Ajax")&&(this.proxy.ignore("error","onLoadError",this).ignore("load","onLoad",this).ignore("loadstart","onLoadStart",this).ignore("timeout","onLoadError",this),delete this.proxy),"string"==typeof t&&(t=u(t)||{urlBase:t}),(this.proxy=u(t))&&(this.proxy.observe({error:"onLoadError",load:"onLoad",loadstart:"onLoadStart",timeout:"onLoadError",ctx:this}),this.broadcast("set:proxy"))},sort:function(t,e){this.updateView(this.view.ovalues.slice().sort(t.bind(e||this)))},sortBy:function(t,e){this.updateView(i(this,t).sort(n[String(e).toLowerCase()]||n.asc).pluck(1))},stash:function(){this.current&&(this.stache.push(this.current.clone()),delete this.current,this.broadcast("stash"))},toJSON:function(){return this.view.ovalues.invoke("toJSON")},undo:function(t){if(this.stache.length){(isNaN(t)||0>t)&&(t=0);var e=this.stache[t];this.stache.splice(0,t+1),this.current=e,this.onChangeView()}else delete this.current&&this.onChangeView()},updateView:function(i){this.stash(),this.current=t("Hash"),i.forEach(e,this.current),this.onChangeView()},onAdd:function(t){var e,i;return i=t instanceof this.model?t:this.model.create(t),(e=this.data.get(i.id))?e:(this.data.set(i.id,i),i.observe({"before:destroy":"remove",change:"onChangeData",sync:"onModelSync",ctx:this}),i)},onChangeData:function(t,e){this.suspendChange||(this.emptyStash(!0),t===!0||this.broadcast("change:data",e),this.proxy&&(this.loading=this.proxy.loading))},onChangeView:function(t){this.suspendChange||t===!0||this.broadcast("change:view")},onModelSync:function(t,e){if("create"===e){var i=this.data.key(t);this.data.remove(i),this.data.set(t.id,t)}},onLoad:function(t,e,i,s,n){this.broadcast("load:complete",e,i,s,n).load(e,n.options)},onLoadError:function(t,e,i,s,n){this.broadcast("load:error",e,i,s,n.options)},onLoadStart:function(){this.broadcast("load:start")},onRemove:function(t){var e=t.id;return!this.current||this.current.remove(e),this.stache.invoke("remove",e),this.data.remove(e)},prepare:function(t){return R.update(t||R.obj(),this.defaultData)},init:function(){this.parent(arguments),this.stache=[];var e=this.data,i=this.model,s=this.proxy;switch(R.remove(this,"data","model","proxy"),this.data=t("Hash"),this.setModel(i).setProxy(s),_(this.defaultData)||(this.defaultData=R.obj()),R.ntype(e)){case"object":this.load(e);break;case"array":this.add(e)}}}}()),R.def(I.data,"lookup",{value:{collection:f,model:d,schema:p}},"r"),o(S("mixins.DataProcessor"),{constructor:function(){},extend:Object,module:I,parse:function(t,e){return t?O.tpl.parse(t,this.prepare(e)):""},prepare:function(t){var e={"@":this};return"object"==typeof t?R.copy(e,this.process(t),!0):e},process:function(t){switch(R.type(t)){case"object":case"nullobject":return"items"in t?t.items.map(this.processItem,this):t;case"array":return{items:t.map(this.processItem,this)};case D+"-data-store":return{items:t.view.ovalues.map(this.processItem,this)}}return{items:[]}},processItem:function(t){return t.toJSON?t.toJSON():t.src||t}}),o(S("mixins.ClsSlc"),{extend:Object,module:I,clsList:"active collapsed focused disabled expanded hidden item",init:function(){switch(this.slcBase="."+this.clsBase,R.ntype(this.clsList)){case"string":this.clsList=this.clsList.split(" ");case"array":this.clsList.map(this.prefixClsSlc,this)}},prefixClsSlc:function(t){var e=t.split("-").map(g).join(""),i="-"+t;this["cls"+e]=this.clsBase+i,this["slc"+e]=this.slcBase+i}}),o(S("mixins.DOMRefs"),function(){var t="$1",e=/^\$?el(.*)/;return{extend:Object,module:I,selectors:null,slcRef:"[data-ref]",refs:null,suspendApply:0,getRef:function(i,s){return s=Boolean.coerce(s),i=String(i).replace(e,t),i=(s?"":"$")+"el"+i.split("-").map(g),this[i]||null},applySelectors:function(){this.suspendApply||(this.applyDOMRefs(),!_(this.refs)||Object.reduce(this.refs,this.applySelector,this),this.refs.focus||this.elFocus||(this.$elFocus=this.$el,this.elFocus=this.el),this.broadcast("refs:applied"))},unapplySelectors:function(){!_(this.refs)||Object.reduce(this.refs,this.unapplySelector,this),this.broadcast("refs:unapplied")},updateEl:function(t,e){!this.interactive||!(t=this.getRef(t))||this.broadcast("before:update:element",t,e)===!1||this.onUpdateEl(t,e).broadcast("update:element",t)},onUpdateEl:function(t,e){t.html(e)},applyDOMRef:function(t,e){switch(R.type(t)){case"element[]":break;case"htmlelement":t=O.$(t);break;case"string":t=this.$el.find(t);break;default:return}"string"!=typeof e&&(e=t.data("ref")),t&&t.length&&(e="el"+g(e),this["$"+e]=t,this[e]=this["$"+e][0])},applyDOMRefs:function(){Array.coerce(this.$el.find(this.slcRef)).map(this.applyDOMRef,this)},applySelector:function(t,e,i){return t.applyDOMRef(e,i)},init:function(){this.prepareRefs(),_(this.refs)||(this.refs={}),this.slcFocus&&(this.refs.focus=this.slcFocus,delete this.slcFocus),!_(this.selectors)||R.copy(this.refs,this.selectors,!0)},prepareRefs:R.noop,registerEvents:function(){this.observe({destroy:"unapplySelectors",render:"applySelectors",update:"applySelectors"})},unapplySelector:function(t,e,i){return i="el"+g(i),R.remove(this,[i,"$"+i]),t}}}()),o(S("mixins.Renderer"),{extend:Object,module:I,slcCt:"body",tpl:e+".component",transitionTimeout:800,dead:{get:function(){return this.destroyed||this.destroying}},destroyed:!1,destroying:!1,ready:{get:function(){return this.rendered&&!this.dead}},rendered:!1,rendering:!1,$ct:null,$el:null,ct:null,el:null,suspendUpdate:0,render:function(t){this.ready||this.dead||this.broadcast("before:render")===!1||(this.rendering=!0,this.assignContainer(t).onRender().afterRender(),this.rendering=!1)},prepareFragment:function(t,e){var i;switch(R.type(t)){case"object":case"nullobject":case"array":case D+"-data-store":i=this.parse(e,t);break;case"string":break;case"null":i="";break;case"htmlelement":case"documentfragment":return t;case"htmlcollection":case"element[]":i=t;break;default:return null}return"string"==typeof i&&(i=i.trim()),this.fragmentalize(i?i:"")},toElement:function(t,e){return O.$(this.parse(t,e))},afterRender:function(){this.broadcast("after:render"),typeof this.active!="boolean"||this[(this.active===!0?"":"de")+"activate"](),this.focusable!==!1&&(s(this.$elFocus,"blur",this.id+"::blur"),s(this.$elFocus,"focus",this.id+"::focus"),this.focused===!0&&(this.focused=!1,this.focus()))},afterTransition:function(){this.afterEvent&&this.afterEvent in this&&(this.afterTransition_.cb.stop(),delete this.afterEvent,b(this.$el,"transition","afterTransition"),typeof this[this.afterEvent]!="function"||this[this.afterEvent]())},onBeforeTransition:function(t){s(this.$el,"transition","afterTransition"),this.afterEvent=t,this.afterTransition_()},onAppend:function(t){this[this.updateTarget][0].appendChild(t)},onDestroy:function(){this.rendered&&(this.rendered=!1,this.$el.remove(),R.remove(this,"$ct $el ct el".split(" ")))},onRender:function(){this.createDOM(),this.$el.appendTo(this.ct),this.rendered=!0,this.broadcast("render"),this.updateTarget in this||(this.updateTarget=this.$elCt?"$elCt":"$el")},onUpdate:function(t){this[this.updateTarget].html(null)[0].appendChild(t)},assignContainer:function(i){var s=R.type(i);R.exists(i)&&("element[]"==s?this.$ct=i:"string"==s||"htmlelement"==s?this.$ct=O.$(i):t.is(i,e+".Box")?this.$ct=i[i.prop.ctItems]||i.$elCt||i.$el:this.slcCt&&(this.$ct=O.$(this.slcCt))),this.$ct&&(this.ct=this.$ct[0])},createDOM:function(){this.$el=this.toElement(this.tpl,null).attr("id",this.id),this.el=this.$el[0],!this.$el.hasClass(this.clsDefault)||this.$el.addClass(this.clsDefault),~this.el.firstElementChild.className.indexOf(this.clsBase+"-ct")&&(this.elCt=this.el.firstElementChild,this.$elCt=O.$(this.elCt))},fragmentalize:function(t){var e=B.createDocumentFragment();return O.$(t).appendTo(e),e},init:function(){this.tpl=O.tpl.create(this.tpl),this.afterTransition_=this.afterTransition.callback({ctx:this,delay:this.transitionTimeout+100})}}),o(S("mixins.BoxRenderer"),{extend:S("mixins.Renderer"),module:I,autoRender:!0,tpl:e+".box",onRemove:function(t){t.$el.remove()},onRender:function(){this.parent().renderItems()},adopt:function(t,e,i){this.rendered&&this.autoRender!==!1&&(t.render(this[this.$_items]).$el.css("display","none"),!e||t.$el.insertBefore(this.items[i>=0?i:this.items.length+i].el),t.$el.css("display",""))},destroyItem:function(t){return t.destroy()},renderItem:function(t){return t.rendered&&this.el.contains(t.el)?t:t.render(this[this.$_items])},renderItems:function(){!this.items.length||this.items.map(this.renderItem,this)}}),o(S("mixins.Validation"),{extend:Object,module:I,allowDecimals:!0,max:Number.POSITIVE_INFINITY,min:Number.NEGATIVE_INFINITY,pattern:null,required:!1,isValid:function(t){return I.Validate[this.inputType].valid(this,t)},validate:function(t){var e=this.value,i=this.isValid(e)&&this.onValidate(e);return t===!0||this.broadcast("validate").broadcast((i?"":"in")+"valid"),this.interactive&&(this.$el.removeClass(this.clsValid).removeClass(this.clsInvalid),t!==!0?this.$el.addClass(this["cls"+(i?"Valid":"Invalid")]):this.$elField.val()!=""||this.$el.addClass(this["cls"+(i?"Valid":"Invalid")])),i},onValidate:function(t){return this.required!==!0||I.Validate[this.inputType].minmax(this,t)},init:function(){},registerEvents:function(){this.observe("change","validate",this)}}),o(S("layout.Layout"),{constructor:function(t){R.copy(this,t||{}),this.afterLayout_=this.afterLayout.callback({ctx:this,delay:50}),this.cmp.rendered?this.init():this.cmp.once("after:render","init",this)},extend:Object,$el:null,cmp:null,disabled:!1,el:!1,items:null,slcItem:null,disable:function(){this.disabled=!0},enable:function(){this.disabled=!1},forceLayout:function(){this.busy=!1,this.layout(!0)},layout:function(t){return t=t===!0,this.cmp&&this.cmp.rendered&&!this.el&&this.init(),this.disabled||this.busy?void 0:this.refresh(t).beforeLayout(t)===!1?(this.busy=!1,void 0):(this.onLayout(t).afterLayout_(t),void 0)},afterLayout:function(){this.busy=!1},beforeLayout:function(){this.busy=!0},onLayout:function(){},refresh:function(){},sync:function(){},init:function(){var t=this.cmp,e=t.el;this.$el=t.$el,this.el=e,this.slcItem=t.slcItem,this.elOffset=/absolute|relative/.test(k.getComputedStyle(e,null).position)?e:e.offsetParent,t.observe({"change:dom":"forceLayout",ctx:this,options:{delay:200}}),!t.rendered||!t.active||this.layout()}}),o(S("Component"),{constructor:function(){this.parent(arguments).mixin("observer",[this.__config__.observers]).mixin("processor").registerEvents()},extend:t.Source,mixins:{clslc:e+".mixins.ClsSlc",observer:"Observer",processor:e+".mixins.DataProcessor",domrefs:e+".mixins.DOMRefs",renderer:e+".mixins.Renderer"},module:I,autoLoad:!0,bound:null,cls:null,clsAnim:"w-anim",clsBase:"w-cmp",clsDefault:"w-cmp",focusable:!0,html:null,layout:null,slcFocus:null,tagName:"div",updateTarget:"$elCt",collapsed:{get:function(){return this.ready&&this.$el.hasClass(this.clsCollapsed)},set:function(t){return t=!!t,this.collapsed!==t&&this[t?"collapse":"expand"](),t}},visible:{get:function(){return this.ready&&!(this.$el.hasClass(this.clsHidden)||!this.$el.displayed())},set:function(t){return t=!!t,this.visible!==t&&this[t?"show":"hide"](),t}},active:null,focused:!1,disabled:!1,interactive:{get:function(){return this.ready&&this.visible&&!this.disabled}},id:null,activate:function(){this.active===!0||!this.interactive||this.broadcast("before:activate")===!1||this.onActivate().broadcast("activate")},append:function(t,e){this.dead||(this.rendered||this.render(),t===$||this.disabled||this.broadcast("before:append",t,e)===!1||this.onAppend(t,e||this.tplContent))},blur:function(t){!this.interactive||this.focusable===!1||!this.focused||this.broadcast("before:blur",t)===!1||this.onBlur().broadcast("blur",t)},collapse:function(){this.collapsed||!this.interactive||this.broadcast("before:collapse")===!1||this.onCollapse().broadcast("collapse")},deactivate:function(){this.active===!1||!this.interactive||this.broadcast("before:deactivate")===!1||this.onDeactivate().broadcast("deactivate")},destroy:function(){!this.interactive||this.mixin("observer")},disable:function(){this.disabled||this.broadcast("before:disable")===!1||this.onDisable().broadcast("disable")},enable:function(){!this.disabled||this.broadcast("before:enable")===!1||this.onEnable().broadcast("enable")},expand:function(){!this.collapsed||!this.interactive||this.broadcast("before:expand")===!1||this.onExpand().broadcast("expand")},focus:function(t){!this.interactive||this.focusable===!1||this.focused||this.broadcast("before:focus",t)===!1||this.onFocus().broadcast("focus",t)},hide:function(){this.rendered||this.render(),!this.visible||!this.interactive||this.broadcast("before:hide")===!1||this.onHide()},load:function(t){this.suspendApply||++this.suspendApply,this.disabled||this.broadcast("before:load",t)===!1||(this.store.fetch(t),this.broadcast("load:start",t))},loadAppend:function(t){this.suspendApply||++this.suspendApply,this.disabled||this.broadcast("before:load",t)===!1||(this.store.fetch(t,{append:!0}),this.broadcast("load:start",t))},refreshView:function(t,e){!this.suspendApply||--this.suspendApply,this.applySelectors(),this.store&&(this[_(e)&&e.append===!0?"append":"update"](this.store.toJSON()),this.store.findAll(function(t){return!this.has(t.id)},this.store.view).invoke("getBoundEl",this).invoke("remove"))},replaceCached:function(){!this.bound||this[this.updateTarget].find(".replace-cached").map(this._replaceCached,this)},show:function(){this.rendered||this.render(),!this.ready||this.visible||this.broadcast("before:show")===!1||this.onShow()},update:function(t,e){this.dead||(this.rendered||this.render(),this.suspendUpdate||(t&&t!==this||!this.store||(t=this.store),t===$||this.disabled||this.broadcast("before:update",t,e)===!1||this.onUpdate(t,e||this.tplContent)))},updateBindings:function(){this.store.bindView(this),this.bound=this.store.data.aggregate(this.bound||R.obj(),this._updateBindings,this)},afterActivate:function(){this.broadcast("after:activate")},afterAppend:function(){this[this.updateTarget].find(".replace-cached").remove(),!this.store||this.replaceCached().updateBindings(),this.broadcast("append").broadcast("change:dom")},afterCollapse:function(){this.broadcast("after:collapse")},afterDeactivate:function(){this.broadcast("after:deactivate")},afterExpand:function(){this.broadcast("after:expand")},afterHide:function(){this.broadcast("after:hide")},afterShow:function(){this.broadcast("after:show")},afterUpdate:function(){!this.store||this.replaceCached().updateBindings(),this.broadcast("update").broadcast("change:dom")},onActivate:function(){this.onBeforeTransition("afterActivate"),this.active=!0,this.$el.addClass(this.clsActive)},onAppend:function(t,e){var i=this.prepareFragment(t,e);!i||this.mixin("renderer",[i]).afterAppend()},onBlur:function(){this.focused=!1,this.$el.removeClass(this.clsFocused),!this.elFocus||this.elFocus.blur()},onCollapse:function(){this.ready&&(this.onBeforeTransition("afterCollapse"),this.$el.addClass(this.clsCollapsed))},onDeactivate:function(){this.onBeforeTransition("afterDeactivate"),this.active=!1,this.$el.removeClass(this.clsActive)},onDestroy:function(){y(this),this.mixin("renderer")},onDisable:function(){this.disabled=!0,!this.ready||this.$el.addClass(this.clsDisabled)},onEnable:function(){this.disabled=!1,!this.ready||this.$el.removeClass(this.clsDisabled)},onExpand:function(){this.ready&&(this.onBeforeTransition("afterExpand"),this.$el.removeClass(this.clsCollapsed))},onFocus:function(){this.focused=!0,this.$el.addClass(this.clsFocused),!this.elFocus||this.elFocus.focus()},onHide:function(){this.onBeforeTransition("afterHide"),this.$el.addClass(this.clsHidden)},onRender:function(){this.store&&(this.store.size?this.once("after:render",this.update,this):this.autoLoad!==!1&&this.load()),this.mixin("renderer"),!this.disabled||this.disable(),this.hidden===!0&&(this.hide(),delete this.hidden)},onShow:function(){this.onBeforeTransition("afterShow"),this.$el.removeClass(this.clsHidden)},onUpdate:function(t,e){var i=this.prepareFragment(t,e);!i||this.mixin("renderer",[i]).afterUpdate()},registerEvents:function(){this.mixin("dataview").mixin("domrefs"),this.once("before:render","initLayout",this),!this.store||this.store.observe({"change:data":"refreshView","change:view":"refreshView",ctx:this})},_replaceCached:function(t){var e,i=t.getAttribute("data-replace-id"),s=t.parentNode,n=this.bound[i];n?(e=O.$(t).data(),delete e.replaceId,s.replaceChild(n.data(e)[0],t)):s.removeChild(t)},_updateBindings:function(t,e,i){var s=e.getBoundEl(this.id);return s&&(t[i]=s),t},init:function(){this.parent().mixin("clslc").mixin("dataview").mixin("domrefs").mixin("renderer").initStore(),this.tplContent&&(this.tplContent=O.tpl.create(this.tplContent)||null),this.updateTarget||(this.updateTarget="$elCt"),A.include(this)},initConfig:function(t){return t=this.parent(arguments),this.id=this.id||t.id||this.clsBase+"-"+ ++c(R.type(this)).count,delete t.id,t},initLayout:function(){if(!(this.layout instanceof c("layout.Layout")))switch(R.type(this.layout)){case"string":var t=c(this.layout);t.prototype instanceof c("layout.Layout")&&(this.layout=t.create({cmp:this}));break;case"object":this.layout.cmp=this,this.layout=r(this.layout);break;default:this.layout=null}},initStore:function(){var t=this.store;switch(R.type(t)){case"string":case"function":t=f(t),t&&(this.store=new t);break;case"object":this.store=t instanceof c("data.Collection")?t:widgie.create("data.Collection",t)}},onAction:function(t,e){typeof this[t]=="function"&&this[t](e)},syncSize:function(){}}),c("Component").count=999,R.defs(I,{Mgr:{value:A=t(e+".TypedHash",{Type:I.Component})},get:A.get.bind(A)},"r"),o(S("Box"),{constructor:function(){this.parent(arguments).initItems(this.items)},extend:S("Component"),mixins:{dataview:R.obj(),renderer:e+".mixins.BoxRenderer"},module:I,$_items:"$elCt",clsBase:"w-box",tpl:e+".box",add:function(t){return arguments.length>1&&isNaN(arguments[1])&&(t=Array.coerce(arguments)),Array.isArray(t)?(this.suspendEvents(),t=t.map(this.add,this),this.resumeEvents().broadcast("add",t),t):this.broadcast("before:add",t)!==!1&&(t=this.onAdd(t))?(this.broadcast("add",t),t):null},clear:function(t){this.items.length&&this.ready&&!this.disabled&&this.broadcast("before:clear")!==!1&&(t===!0&&this.suspendEvents(),this.onClear().resumeEvents().broadcast("clear"))},contains:function(t){return t=this.get(t),t&&t.parentBox===this},get:function(t){if(null!==t&&t!==$&&this.items.length)switch(R.type(t)){case"event":t=t.currentTarget;case"element[]":case"htmlelement":t=O.$(t).data("id");case"number":case"string":return this.items[t]||this.map[t]||this.map[this.id+"-"+t]||null;default:return"id"in t||"cmpId"in t?this.get(t.id)||this.get(this.id+"-"+t.cmpId):null}return null},insert:function(t,e){return this.broadcast("before:add",e,t)===!1?null:(e=this.onAdd(e,t),this.broadcast("add",e),e)},loadItems:function(t,e){"string"==typeof t&&(t={url:t}),t.success=this.onLoadItems.bind(this,e),this.disabled||this.broadcast("before:load:items",t)===!1||this.broadcast("load:items:start",O.xhr(t))},remove:function(t,e){return t&&(t=this.get(t))&&this.broadcast("before:remove",t)!==!1?(this.onRemove(t),e!==!0||t.dead||t.destroy(),this.broadcast("remove",t),void 0):null},onAdd:function(t,e){var i=this.get(t);return!i||!t.parentBox||t.parentBox.remove(i),(t=this.lookup(t))?(this.adopt(t,e),t.observe("destroy","onRemove",this),t):null},onClear:function(){for(;this.items.length;)this.remove(this.items[0],!0)},onRemove:function(t){R.remove(this.items,t),delete this.map[t.id],this.mixin("renderer",arguments),t.parentBox===this&&delete t.parentBox},onRender:function(){this.parent()},adopt:function(t,e){var i=R.type(e)=="number";this.map[t.id]=t,!t.parentBox||t.parentBox.remove(t,!1),t.parentBox=this,this.mixin("renderer",[t,i,e]),i?this.items.splice(e,0,t):this.items.push(t)},applyDefaults:function(t){return R.copy(t,this.defaults,!0)},init:function(){this.parent(),_(this.defaults)||(this.defaults={})},initItems:function(t){switch(this.items=[],this.map=R.obj(),R.ntype(t)){case"array":this.add(t);break;case"string":case"object":this.loadItems(t,!1)}},lookup:function(i){return"string"==typeof i&&(i=A.get(i)),_(i)&&!i.id&&i.cmpId&&(i.id=this.id+"-"+i.cmpId),_(i)||E({cmp:this,item:i,message:"Incorrect Type: cannot add item - "+JSON.stringify(i)+"  to "+this.id,method:"lookup",name:E.code.BOX_ITEM_LOOKUP}),t.is(this.applyDefaults(i),e+".Component")?i:r(i)},onLoadItems:function(t,e){t===!0||this.clear(!0),!(!Array.isArray(e)||!_(e))||this.add(e),this.broadcast("load:items:complete")}}),c("Box").count=999,o(S("Form"),function(){function t(t,e){return t[e.name||e.cmpId||e.id]=e.value,t}function i(t,e){return t.append(e.name,e.value),t}return{constructor:function(){this.parent(arguments)},extend:e+".Box",module:I,async:!0,clsBase:"w-form",clsDefault:"w-form",proxy:null,upload:!1,valid:{get:function(){return this.fields.pluck("valid").every(R)}},value:{get:function(){return this.fields.reduce(this.upload===!0?i:t,this.upload===!0?new FormData:R.obj())}},reset:function(){!this.interactive||this.broadcast("before:reset")===!1||this.onReset().broadcast("reset")},submit:function(){if(this.interactive){var t=this.valid;return t?(this.onValid().broadcast("before:submit")===!1||this.onSubmit().broadcast("submit"),void 0):(this.onInvalid(),void 0)}},afterRender:function(){this.parent(arguments),s(this.$el,"keyup",this.id+"::onKeyPress"),this.async===!1&&this.proxy&&(this.$el.attr({action:this.proxy.urlBase,method:this.proxy.method}),s(this.$el,"submit",this.id+"::handleSubmit"),this.upload===!0&&this.$el.attr("enctype","multipart/form-data"))},onAdd:function(t){(t=this.parent(arguments))&&(t instanceof c("Field")&&this.fields.push(t.observe("dom:blur",this.onTab,this)),t.relayEvents(this,"change","validate"))},onChange:function(){},onInvalid:function(){this.$el.removeClass(this.clsValid).addClass(this.clsInvalid)},onLoad:function(){},onLoadError:function(){},onLoadStart:function(){},onRemove:function(t){t.parentBox===this&&R.remove(this.fields,t),this.parent(arguments)},onReset:function(){this.$el.removeClass(this.clsInvalid).removeClass(this.clsValid),this.fields.invoke("reset")},onSubmit:function(){this.async===!1?this.el.submit():this.proxy&&this.proxy.load(this.value)},onTab:function(t,e){if(e){var i=this.fields.indexOf(t);~i&&(i+=e.shiftKey===!0?-1:1,!this.fields[i]||this.fields[i].focus())}},onValid:function(){this.$el.removeClass(this.clsInvalid).addClass(this.clsValid)},onValidate:function(){},handleSubmit:function(t){this.async===!1&&this.valid||t.stop("11")},onKeyPress:function(t){var e=O.$.event.KEY_CODE;(t.which===e.ENTER||t.which===e.RETURN)&&this.submit()},init:function(){this.clsList+=" invalid valid",this.fields=[],this.async===!1&&(this.tagName="form"),this.parent(arguments).initProxy()},initProxy:function(){typeof this.proxy=="string"&&(this.proxy={urlBase:this.proxy}),(this.proxy=u(this.proxy))&&this.proxy.observe({error:"onLoadError",load:"onLoad",loadstart:"onLoadStart",timeout:"onLoadError",ctx:this})},registerEvents:function(){this.parent(arguments).observe({change:"onChange",validate:"onValidate",ctx:this})}}}()),o(S("Field"),function(){return{constructor:function(){this.parent(arguments)},extend:e+".Component",mixins:{validation:e+".mixins.Validation"},module:I,clsBase:"w-field",errorMsg:null,format:null,inputType:null,multiLine:!1,name:null,toolTip:null,tpl:D+".field",watchInterval:10,label:{get:function(){return n(this).label},set:function(t){return n(this).label=t,this.ready&&this.$elLabel.html(n(this).label),this.label}},valid:{get:function(){return this.validate(!0)}},value:{get:function(){return n(this).value},set:function(t){var e=n(this),i=this.rawToVal(t);return this.valToRaw(i),R.empty(t)&&!R.empty(e.value)?(e.val_prev=e.value,e.value=$,this.broadcast("change",e.value,e.val_prev)):i!==e.value&&(this.isValid(i)?(e.val_prev=e.value,e.value=i,this.ready&&(this.inputType=="file"||this.$elField.val(this.valToRaw(i)),this.broadcast("change",i,e.val_prev))):this.ready&&(this.inputType=="file"||this.$elField.val(this.valToRaw(e.value)),this.broadcast("change",e.value,e.val_prev))),e.value}},_iid:null,_inputType:null,$elField:null,$elLabel:null,elField:null,elLabel:null,clear:function(){!this.interactive||this.broadcast("before:clear")===!1||this.onClear().broadcast("clear")},reset:function(){!this.interactive||this.broadcast("before:reset")===!1||this.onReset().broadcast("reset")},rawToVal:function(t){return I.Validate[this.inputType].val(this,t)},valToRaw:function(t){return I.Validate[this.inputType].raw(this,t)},afterRender:function(){switch(this.parent(arguments),this.$elField.val(this.value),this.inputType){case"checkbox":case"radio":s(this.elField,"click",this.id+"::onFocus");break;case"file":s(this.elField,"change",this.id+"::handleChange")}},onBlur:function(){this.parent(arguments).watchStop().validate()},onClear:function(){this.$elField.val(""),this.handleChange()},onFocus:function(){this.parent(arguments).watchStart().validate()},onReset:function(){this.$elField.val(n(this).val_initial),this.handleChange()},handleBlur:function(t){!t||t.target!==this.elFocus||this.broadcast("dom:blur",t)},handleChange:function(){var t=this.$elField.val();this.value=this.inputType=="file"&&R.ntype(t)=="filelist"?t[0]:t},handleFocus:function(t){!t||t.target!==this.elFocus||this.broadcast("dom:focus",t)},init:function(){this.clsList+=" invalid valid",this.slcFocus="."+this.clsBase+"-input",this.name=this.name||this.cmpId||this.id,this.handleChange_=this.handleChange.bind(this),this.inputType!=="date"||this.format||(this.format="c"),this._inputType=this.inputType==="number"?"text":this.inputType,this.parent(arguments).mixin("validation");var t=n(this);t.val_initial=this.value},registerEvents:function(){this.parent(arguments).mixin("validation",arguments)},watchStart:function(){this._iid===null&&(this._iid=setInterval(this.handleChange_,this.watchInterval),this.handleChange())},watchStop:function(){this._iid!==null&&(clearInterval(this._iid),this._iid=null,this.handleChange())}}}()),t.define(S("Error"),function(){return{constructor:function(t){_(t)||(t="string"==typeof t?{message:t}:{}),R.copy(this,t),this.trace().parent()},extend:Error,module:I,name:g(e)+"Error",toString:function(){return this.message},trace:Error.caputureStackTrace?function(){switch(typeof this.method){case"string":if(!this.cmp||typeof this.cmp[this.method]!="function")break;this.method=this.cmp[this.method];case"function":Error.captureStackTrace(this,this.method)}}:R.noop}}()),E.code={BOX_ITEM_LOOKUP:"BoxItemLookupError"},!function(){if(R.ENV=="browser"){var t=h.callback({buffer:200}),e=l.callback({buffer:200}),i=["blur","focus","resize","click","dblclick","change","select","submit","keydown","keypress","keyup","animationend","animationiteration","animationstart","transitionend"],s=["orientationchange","resize"];j.desktop&&i.push("mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup"),i.map(function(t){this.on(t,"[data-"+t+"]",h)},O.$(j.ie?k:B)),j.android?(k.addEventListener("resize",e,!0),k.addEventListener("orientationchange",e,!0)):(s.map(function(t){this.on(t,"[data-"+t+"]",e)},O.$(k)),j.ie?k.addEventListener("scroll",t,!0):O.$(j.ie?k:B).on("scroll","[data-scroll]",t))}}(),O.$.ready(function(){var t=r(S("Box"),{$_items:"$el",clsBase:"w-viewport",$ct:O.$(B.documentElement),ct:B.documentElement,id:"viewport"});t.$el=O.$(t.el=B.body),t.rendered=!0,t.$el.addClass(t.clsBase).attr("id",t.id),R.def(I,"Viewport",{value:t},"cw"),t.broadcast("viewport:ready")})}("undefined"!=typeof id8?id8:"undefined"!=typeof require?require("id8"):null,"widgie");