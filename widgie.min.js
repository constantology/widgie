!function(t,e,i){function s(t,e,i){var s,t=N.$(t);return t.length&&(s=t.attr("data-"+e),s&&(i+="|"+s),t.attr("data-"+e,i)),V}function n(t){return F[t.id]||(F[t.id]=B.obj())}function a(t){if(i=t.getAttribute("data-cmp-id")||t.id,i&&(e=O.get(i)))return e;var e,i,s=t;do if(s.id&&(e=O.get(s.id)))return t.setAttribute("data-cmp-id",s.id),e;while(s=s.parentElement);return null}function r(t,e){T(t)&&(e=t,t=e.widgie||e.type),I(t)||(t="widgie.Component");var i=c(t)||V.Component;return i.create(e)}function o(e,i){return(T(e)||S(e))&&(i=e,S(i)&&(i=i())),I(e)||(e=i.namespace||y(i.type),delete i.namespace),m(e,t.define(e,i))}function c(e){var i=t.get(e)||U[e];return i||(e=e.toLowerCase(),i=t.get("w."+e)||U[e],i||(e=e.replace(/\./g,"-"),i=t.get(e)||U[e])),i||null}function h(t){switch(t.type){case"blur":case"focus":if(t.target===M.activeElement&&t.target.getAttribute("tabindex")&&t.target!==t.currentTarget)return}v(t.currentTarget,t)}function l(t){Array.coerce(M.querySelectorAll("[data-"+t.type+"]")).forEach(function(e){v(e,t)})}function u(t){switch(B.ntype(t)){case"string":return c(t);case"function":return t instanceof c("data.Model")?t:null}return null}function d(t,e){switch(B.ntype(t)){case"object":t=t instanceof c("proxy.Ajax")?t:r(e||"proxy.Ajax",t);break;case"string":t=c(t);case"function":t=new t;break;default:t=null}return t||null}function f(t,e){switch(B.ntype(t)){case"array":t={properties:t};case"object":t=t instanceof c("data.Schema")?t:r(e||"data.Schema",t);break;case"string":t=c(t);case"function":t=new t;break;default:t=null}return t||null}function p(t){switch(B.ntype(t)){case"string":return c(t);case"function":return t instanceof c("data.Store")?t:null}return null}function m(t,e){var i,s=t.indexOf("widgie");return(0===s||1===s)&&(i=t.split(".").slice(1).join(".")),I(i)&&(U[i.toLowerCase().split(".").join("-")]=U[i]=e),e}function b(t,e,i){var s,n,t=N.$(t);return t.length&&(n=t.attr("data-"+e).split("|"),n.length&&(~(s=n.indexOf(i))&&n.splice(s,1),t.attr("data-"+e,n.join("|")))),V}function v(i,s){(i===M||i===P)&&(i=M.body);var n=i.getAttribute("data-"+s.type);I(n)&&n.split("|").forEach(function(n){var r;switch(n=n.split("::"),n.length){case 1:n=n.shift();break;case 2:return r=O.get(n.shift()),n=n.shift(),!t.is(r,e+".Component")||r.onAction(n,s),void 0}!(r=a(i))||r.onAction(n,s)})}function g(t){return delete F[t.id]}function y(t){return t+="",t.charAt(0).toUpperCase()+t.substring(1)}function x(t){return Array.isArray(t)}function w(t){return"boolean"==B.ntype(t)}function C(t){return"date"==B.ntype(t)}function _(t){return"htmlelement"==B.type(t)}function S(t){return"function"==B.ntype(t)}function T(t){return"object"==B.ntype(t)}function E(t){return"number"==B.type(t)}function I(t){return"string"==B.ntype(t)}function $(t){return t===!0}function j(t){return"^"+e+"."+t}function L(e){if(B.got(e,"type")&&(B.has(L.code,e.type)&&(e.name=L.code[e.type]),delete e.type),e=t(j("Error"),e),V.debug)throw e;return console.log(e),e}var A,O,D,k,R=e.toLowerCase(),B=t.util,V=B.obj(),N=B.obj(),P=B.global,M=P.document,F=B.obj(),U=B.obj();N.$=dinero,N.date={coerce:function(t,e){return Date.coerce(t,e)},format:function(t,e){return t.format(e)}},N.tpl={create:function(t){return t instanceof Templ8?t:Templ8.get(t)||new Templ8(t)},get:function(t){return N.tpl.create(t)},parse:function(t,e){return t.parse(e)}},N.ua=k=dinero.ua,N.xhr=function(){function t(t){return t.removeEventListener("error",t._onerror,!0),t.removeEventListener("load",t._onload,!0),delete t._onerror,delete t._onload,delete t._config,t}function e(t){var e=((t.getResponseHeader("Content-Type")||"").split("/")[1]||"").split(";")[0],i=t.responseText.trim().replace(/^[\n\r\s\t]+/m,"");switch(t.responseType||e){case"json":case"javascript":return T(t.response)?t.response:0!==i.indexOf("<")?JSON.parse(i):null;case"arraybuffer":case"blob":case"document":return t.response;case"html":case"xml":return I(t.response)?t.responseXML:t.response;case"text":case"":return t.responseText}return a(t)}function i(){var i=this,s=i._config;!S(s.error)||s.error(e(i),i.status,t(i),s)}function s(){var i=this,s=i._config;!S(s.success)||s.success(e(i),i.status,t(i),s)}function n(t,e,i){return t.setRequestHeader(i,e),t}function a(t){try{return JSON.parse(t.responseText)}catch(e){return t.responseXML||t.responseText}}var r=/DELETE|POST|PUT/i,o={Accept:"*/*;q=0.5,application/json,application/javascript,text/javascript,application/ecmascript,application/x-ecmascript","Content-Type":"application/json;charset=UTF-8","X-Requested-With":"XMLHttpRequest"};return function(t){var e,a,c,h=new XMLHttpRequest;switch(h._config=t,e=t.data,t.headers=a=B.copy(t.headers||B.obj(),o,!0),c=t.method,c=c?c.toUpperCase():"GET",h.addEventListener("error",h._onerror=i.bind(h),!0),h.addEventListener("load",h._onload=s.bind(h),!0),h.open(c,t.url,!0),r.test(c)&&a["Content-Type"]===o["Content-Type"]&&t.sendJSON!==!0&&(a["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8"),!h.overrideMimeType||h.overrideMimeType(a["Content-Type"]),Object.reduce(t.headers,n,h),B.ntype(e)){case"string":case"formdata":break;case"array":case"object":e=t.sendJSON===!0?JSON.stringify(e):V.qs.encode(e).substring(1);break;default:e=null}return h.send(e),h}}(),!function(){var t={compiled:!0,execute:function(t,e){return"function"==typeof t[e]?t[e].apply(t,Array.coerce(arguments,2)):""},prepare:function(t){return t.prepare(t.data?t.data:null)},sort:function(t,e){return t.values.map(function(t){return[t[e],t]}).sort(function(t,e){return t[0]==e[0]?0:t[0]<e[0]?1:-1}).map(function(t){return t[1]})},toJSON:function(t){return t.valueOf()}};new Templ8(m8.copy({id:"widgie.box",sourceURL:"tpl/box.html"},t),'<{{ @.tagName }} class="{{ @.clsBase }} {{ @.clsDefault if @.clsDefault|exists }} {{ @.cls if @.cls|exists }}"{% if this.focusable !== false %} tabindex="-1"{% endif %}>','	<div class="{{ @.clsBase }}-ct" data-ref="ct"></div>',"</{{ @.tagName }}>"),new Templ8(m8.copy({id:"widgie.component",sourceURL:"tpl/component.html"},t),'<{{ @.tagName }} class="{{ @.clsBase }} {{ @.clsDefault if @.clsDefault|exists }} {{ @.cls if @.cls|exists }}"{% if this.focusable !== false %} tabindex="-1"{% endif %}><div class="{{ @.clsBase }}-ct" data-ref="ct">','	{{ @.html if @.html|type:"string" }}',"	{% if @.tplContent|exists AND @.data|exists %}{{ @|prepare:@.data|parse:@.tplContent }}{% endif %}","</div></{{ @.tagName }}>"),new Templ8(m8.copy({id:"widgie.field",sourceURL:"tpl/field.html"},t),"{% sub label %}",'<label class="{{ clsBase }}-label" data-ref="label" for="{{ id }}-input">{{ label }}</label>',"{% endsub %}","{% sub placeholder %}","placeholder=\"{% if placeholder === ':label' %}{{ label }}{% else %}{{ placeholder }}{% endif %}\"","{% endsub %}",'<{{ @.tagName }} class="{{ @.clsBase }} {{ @.clsDefault if @.clsDefault|exists }} {{ @.cls if @.cls|exists }} {{ @.clsBase }}-{{ @.inputType }}"{% if @.errorMsg %} data-error-msg="{{ @.errorMsg }}"{% endif %} tabindex="-1"><div class="{{ @.clsBase }}-ct" data-ref="ct"{% if @.toolTip %} data-tool-tip="{{ @.toolTip }}"{% endif %}>',"	{% if @.showLabel AND @.labelPosition !== 'after' %}{{ @|parse:\"label\" }}{% endif %}","	<span class=\"{{ @.clsBase }}-input-ct {{ @.clsBase }}-input-{{ @.inputType }}-ct\">{% if @.inputType === 'text' AND @.multiLine === true %}",'		<textarea class="{{ @.clsBase }}-input {{ @.clsBase }}-input-multiline {{ @.clsBase }}-input-{{ @.inputType }}" data-ref="field" id="{{ @.id }}-input" name="{{ @.name }}" {{ @|parse:"placeholder" if @.placeholder|type:"string" }}></textarea>',"	{% else %}",'		<input class="{{ @.clsBase }}-input {{ @.clsBase }}-input-{{ @.inputType }}" data-ref="field" id="{{ @.id }}-input" name="{{ @.name }}" {{ @|parse:"placeholder" if @.placeholder|type:"string" }} type="{{ @._inputType }}" value="{{ @.value if @.value|exists }}" />',"	{% endif %}</span>","	{% if @.showLabel AND @.labelPosition === 'after' %}{{ @|parse:\"label\" }}{% endif %}","</div></{{ @.tagName }}>")}(),B.iter(i)||(i="commonjs"==B.ENV?module:P),B.defs(V=B.expose(V,e,i),{api:{value:N},gestureEnabled:k.touch,ua:{value:k},addDOMListener:s,closest:a,create:r,define:o,error:L,doc:M,getClass:c,global:P,lib:t,removeDOMListener:b,takeAction:v,util:B},"r"),B.expose(t,V),B.expose(B,V),D=t.Class({constructor:function(){this._decode_=this._decode.bind(this),this._encode_=this._encode.bind(this)},extend:Object,decode:function(t){t=0===t.indexOf("?")?t.substring(1):t;var e=B.obj();return t.length?t.split("&").reduce(this._decode_,e):e},encode:function(t){return"?"+Object.reduce(t,this._encode_,"").substring(1)},_decode:function(t,e){e=e.split("=");var i=decodeURI(e.shift()),s=decodeURI(e.shift());return i in t?(Array.isArray(t[i])||(t[i]=[t[i]]),t[i].push(s)):t[i]=s,t},_encode:function(t,e,i){switch(i="&"+encodeURI(i)+"=",B.ntype(e)){case"array":t+=i+e.map(encodeURI).join(i);break;case"date":e=+e;case"boolean":case"number":case"string":t+=i+encodeURI(e)}return t}}),B.def(V,"qs",{value:new D},"cw"),t.define(j("Gesture"),function(){function e(t){this.gesture=t,this.tolerance=t.tolerance}function i(t,e,i){return t>=e&&i>=t}function s(){!l||l.cancel()}function n(t){if(l)l.end(t);else{var e,i=N.$(t.target).closest(m)[0];if(!i)return;if(e=c[B.id(i)],!e||!e.interactive||!e.valid(t.target))return;e.end(t)}l=null}function a(t){!l||l.move(t)}function r(t){var e,i=N.$(t.target).closest(m)[0];i&&(e=c[B.id(i)],e&&e.interactive&&e.valid(t.target)&&(!l||l.cancel(),l=e.start(t)))}P.addEventListener("beforeunload",function(){P.removeEventListener("scroll",h,!0),P.removeEventListener(k.mspoint?"MSPointerUp":"touchend",n,!0),P.removeEventListener(k.mspoint?"MSPointerMove":"touchmove",a,!0),P.removeEventListener(k.mspoint?"MSPointerDown":"touchstart",r,!0)},!0);var o="data-gesture-hotspot",c=B.obj(),h=s.callback({buffer:100,delay:100}),l=null,u=P.document,d={x:{backward:"left",diff:"diffX",dir:"directionX",forward:"right",id:"x",last:"lastX",page:"pageX",start:"startX"},y:{backward:"up",diff:"diffY",dir:"directionY",forward:"down",id:"y",last:"lastY",page:"pageY",start:"startY"}},f="initialRotation initialScale pressure rotation scale touches".split(" "),p=180/Math.PI,m="["+o+'="true"]';return P.addEventListener("scroll",h,!0),P.addEventListener(k.mspoint?"MSPointerUp":"touchend",n,!0),P.addEventListener(k.mspoint?"MSPointerMove":"touchmove",a,!0),P.addEventListener(k.mspoint?"MSPointerDown":"touchstart",r,!0),e.prototype={constructor:e,angle:-1,diffX:null,diffY:null,directionX:null,directionY:null,gesture:null,lastX:null,lastY:null,startX:null,startY:null,tolerance:null,type:null,x:null,y:null,end:function(){var t=Math.abs(E(this.x)?this.startX-this.x:this.lastX-this.startX),e=Math.abs(E(this.y)?this.startY-this.y:this.lastY-this.startY),s=Math.round(Math.atan2(e,t)*p),n="";n+=i(s,0,this.tolerance)?this.directionX||"":i(s,60,60+this.tolerance)?this.directionY||"":(this.directionX||"")+(this.directionY||""),this.angle=s,this.type=n},process:function(t){this.setCoord("x",t),this.setCoord("y",t)},setCoord:function(t,e){var i,s=d[t],n=s.diff,a=s.dir,r=s.last,o=s.start;E(this[t])?(this[r]=this[t],this[t]=e[s.page],i=this[n]=this[t]-this[r],this[a]=0>i?s.backward:i>0?s.forward:null):this[t]=this[o]=e[s.page]}},{constructor:function(t){this.increasePressure_=this.increasePressure.bind(this),this.mixin("observer",T(t)?t.observers:[]).parent(arguments)},extend:t.Source,mixins:{observer:"Observer"},module:V,active:!1,destroyed:!1,disabled:!1,exclusions:null,initialRotation:null,initialScale:null,interactive:{get:function(){return!this.destroyed&&!this.disabled},set:function(){return this.interactive}},longtapDelay:700,rotation:null,precision:.17,pressInterval:100,pressure:null,scale:null,tapDelay:200,tolerance:15,touches:null,id_dbltap:null,id_lngtap:null,is_dbltap:!1,is_lngtap:!1,ts_tap:null,cancel:function(){this.active&&(this.active=!1,this.reset().broadcast("cancel"))},end:function(t){this.interactive&&this.active&&this.broadcast("before:end",t)!==!1&&(this.process(t),this.active=!1,this.ts_tap?this.id_dbltap=setTimeout(this.onEnd.bind(this,t),this.tapDelay):this.onEnd(t))},enable:function(){this.disabled&&this.broadcast("before:enable")!==!1&&(this.disabled=!1,this.broadcast("enable"))},disable:function(){this.disabled||this.broadcast("before:disable")===!1||(this.disabled=!0,this.broadcast("disable"))},increasePressure:function(){this.pressure+=1,this.ts_tap&&Date.now()-this.ts_tap>=this.longtapDelay&&(this.is_lngtap=!0)},move:function(t){if(this.active&&this.interactive){this.process(t);var e=2*this.tolerance;e>this.diffX&&e>this.diffY||this.broadcast("move",t)}},reset:function(){this.cleanup(),!this.active&&this.interactive&&(B.remove(this,f),this.broadcast("reset"))},start:function(t){this.interactive&&!this.active&&this.broadcast("before:start",t)!==!1&&(this.id_dbltap&&i(Date.now()-this.ts_tap,0,this.tapDelay)&&(this.cleanup().is_dbltap=this.active=!0),this.is_dbltap!==!0&&this.is_lngtap!==!0&&(this.reset(),this.active=!0,this.initialRotation=t.rotation,this.initialScale=t.scale,this.pressure=0,this.touches=[],this.id_lngtap=setInterval(this.increasePressure_,this.pressInterval),this.ts_tap=Date.now(),this.process(t).broadcast("start",t)))},valid:function(t){return null===this.exclusions||!N.$(t).closest(this.exclusions).length},cancelPress:function(){P.clearInterval(this.id_lngtap),delete this.id_lngtap},cancelTap:function(){P.clearTimeout(this.id_dbltap),delete this.id_dbltap},cleanup:function(){B.remove(this.cancelPress().cancelTap(),"is_dbltap","is_lngtap","ts_tap")},init:function(){this.parent(arguments),I(this.el)&&(this.el=u.querySelector(this.el)||u.getElementById(this.el)||null),_(this.el)&&(c[B.id(this.el)]=this,this.el.setAttribute(o,"true")),Array.isArray(this.exlusions)&&(this.exclusions=this.exclusions.join(", ")),this.observe({move:this.cleanup,ctx:this})},onDestroy:function(){delete c[B.id(this.el)],this.parent(arguments)},onEnd:function(t){!x(this.touches)||this.touches.invoke("end");var e=this.resolve(t);this.cleanup().broadcast(e,t).broadcast("end",t)},process:function(t){var e=Array.coerce(t.touches,0,2);this.rotation=t.rotation,this.scale=t.scale,e.length&&this.touches.length<=e.length&&e.forEach(this.processTouch,this)},processTouch:function(t,i){this.touches[i]||(this.touches[i]=new e(this)),this.touches[i].process(t)},resolve:function(){var t=this.touches;switch(t.length){case 2:if(i(this.rotation,-300,-60)||i(this.rotation,60,300))return"rotate";if(Math.abs(Math.abs(this.initialScale)-Math.abs(this.scale))>this.precision)return this.initialScale>this.scale?"pinch":"zoom";default:return this.is_dbltap===!0?"doubletap":this.is_lngtap===!0?"longtap":!t[0].type&&Date.now()-this.ts_tap>=this.tapDelay?"tap":"swipe"+t[0].type}}}}()),t.define(j("TypedHash"),function(){return{constructor:function(e){var i;T(e)||(e={}),B.got(e,"Type","data","propId")?(this.Type=S(e.Type)?e.Type:t.get(e.Type)||Object,this.propId=e.propId||"id",i=e.data):B.empty(e)||(i=e),this.parent(i)},extend:"Hash",module:V,propId:"id",Type:null,add:function(t){var e=t instanceof this.Type?t:this.Type.create.apply(this.Type,arguments);return this.set(e[this.propId]||B.id(e),e),e},get:function(t){return B.exists(t)?(I(t)||(t=t[this.propId]),this.parent(t)):null},has:function(t){return I(t)||(t=t[this.propId]),this.parent(t)},include:function(t){return this.has(t)?!1:this.add(t)},set:function(t,e){T(t)&&t.constructor===Object?this.parent(t):e instanceof this.Type&&this.parent(t,e)}}}()),B.def(V,"Validate",{value:{date:{minmax:function(t,e){return t.max>=e&&e>=t.min},raw:function(t,e){return e},val:function(t,e){return e},valid:function(t,e){return"date"==B.ntype(e)&&t.max>=e&&e>=t.min}},number:{minmax:function(t,e){return t.max>=e&&e>=t.min},raw:function(){},val:function(){},valid:function(t,e){return"number"==B.type(e)&&(t.allowDecimals||Math.floor(e)===e)}},checkbox:{minmax:function(){return!0},raw:function(t,e){return e},val:function(t,e){return e},valid:function(t){return!t.elField||t.elField.checked===!0}},text:{minmax:function(t,e){return e.length<=t.max&&e.length>=t.min},raw:function(t,e){return e},val:function(t,e){return e},valid:function(t,e){return"string"==typeof e&&(!t.pattern||t.pattern.test(e))}}}},"cw"),V.Validate.radio=V.Validate.checkbox,V.Validate.password=V.Validate.text,o(j("proxy.Ajax"),function(){function e(t,e){this.loading=!1,!this.interactive||"abort"==status||this.onReqAbort(t,e.options).broadcast("abort",err,e.options)}function i(t,e,i,s){this.loading=!1,!this.interactive||this.onReqError(t,e,i,s.options).broadcast("error",i,e,t,s.options)}function s(t,e,i,s){this.loading=!1,!this.interactive||"object"!=typeof t||this.onReqLoad(t,e,i,s.options).broadcast("load",t,e,i,s.options)}function n(){this.loading=!1,this.abort().onReqTimeout(this.current).broadcast("timeout",this.current)}return{constructor:function(t){this.mixin("observer",T(t)?t.observers:[]).parent(arguments)},extend:t.Source,mixins:{observer:"Observer"},module:V,defaultData:null,headers:null,method:"get",timeout:3e4,urlBase:null,interactive:{get:function(){return!this.disabled},set:function(){return this.interactive}},loading:!1,lastConfig:null,tid:null,abort:function(){!this.current||this.current.abort()},disable:function(){this.disabled||this.broadcast("before:disable")===!1||(this.disabled=!0,this.onDisable().broadcast("disable"))},enable:function(){this.disabled&&this.broadcast("before:enable")!==!1&&(this.disabled=!1,this.onEnable().broadcast("enable"))},load:function(t,e,i){T(e)&&(i=e,e=A),e&&"string"==typeof e||(e=this.method||"GET"),e=e.toUpperCase(),this.interactive&&this.broadcast("before:load",t,e,i)!==!1&&this.onLoadStart(this.createUrl(t=this.prepareData(t)),e,t,i)},reload:function(){this.lastConfig&&this.interactive&&this.broadcast("before:reload")!==!1&&this.doRequest(this.lastConfig)},onReqAbort:function(){},onReqError:function(){},onReqLoad:function(){},onReqTimeout:function(){},createUrl:function(){return this.urlBase},doRequest:function(t){return this.lastConfig=t,this.loading=!0,this.current=N.xhr(t),this.tid=setTimeout(this.onTimeout,this.timeout),this.broadcast("loadstart"),this.current},initTransport:function(t,e,i,s){var n={abort:this.onAbort,error:this.onError,headers:this.headers,method:e||this.method,options:s||B.obj(),success:this.onLoad,url:t};return("POST"===e||"PUT"===e)&&(n.data=i),n},prepareData:function(t){return B.copy(t||B.obj(),this.defaultData,!0)},removeTransport:function(){!this.current||delete this.current,clearTimeout(this.tid),delete this.tid},onBeforeLoad:function(){!this.current||this.abort(!0)},onDisable:function(){},onEnable:function(){},onLoadStart:function(){return this.doRequest(this.initTransport.apply(this,arguments))},init:function(){this.onAbort=e.bind(this),this.onError=i.bind(this),this.onLoad=s.bind(this),this.onTimeout=n.bind(this),T(this.defaultData)||(this.defaultData=B.obj());var t=[this.onBeforeLoad,this.removeTransport];this.observe({abort:this.removeTransport,"before:load":t,"before:reload":t,error:this.removeTransport,load:this.removeTransport,timeout:this.removeTransport,ctx:this})}}}()),o(j("proxy.CRUD"),function(){var t={create:{method:"POST",url:"create"},"delete":{method:"POST",url:"delete"},read:{method:"GET",url:"get"},update:{method:"POST",url:"update"}};return{extend:j("proxy.Ajax"),module:V,api:null,create:function(t,e){this.onAPICall("create",t,e)},"delete":function(t,e){this.onAPICall("delete",t,e)},read:function(t,e){this.onAPICall("read",t,e)},update:function(t,e){this.onAPICall("update",t,e)},createUrl:function(t,e){return e.url||this.urlBase},onAPICall:function(t,e,i){t=t in this.api?t:"read";var s=this.api[t];T(i)||(i=B.obj()),i.command=t,s&&this.interactive&&this.broadcast("before:"+t,e,i)!==!1&&this.onLoadStart(this.createUrl(e,s),s.method,e=this.prepareData(e,s),i)},onReqAbort:function(t,e){this.broadcast("abort:"+e.command,t,err,e)},onReqError:function(t,e,i,s){this.broadcast("error:"+s.command,t,e,i,s)},onReqLoad:function(t,e,i,s){this.broadcast(s.command,t,e,i,s)},prepareData:function(t,e){return S(e.data)?e.data(t):t},init:function(){this.parent(arguments).initAPI()},initAPI:function(){T(this.api)||(this.api=B.obj()),Object.reduce(t,this.initAPIMethod,this)},initAPIMethod:function(t,e,i){var s,n=t.api;return i in n&&(s=n[i],I(s)&&(s={url:s}),I(t.urlBase)&&I(s.url)&&(s.url=t.urlBase+(0===s.url.indexOf("/")?"":"/")+s.url),n[i]=B.update(s,e)),t}}}()),o(j("proxy.ModelSync"),function(){return{extend:j("proxy.CRUD"),module:V,api:null,create:function(t,e){var i=e.model.schema.mappings.id;delete t[i],this.parent(t,e)},"delete":function(t){t.exists&&this.parent({id:t.id},{model:t})},read:function(t,e){var i=e.model.schema.mappings.id;this.parent({id:t[i]||e.model[i]},e)},sync:function(t,e){var i="read";t.dirty?i=t.exists?"update":"create":t.exists||(i="create"),T(e)||(e=B.obj()),e.model=t,!(i in this.api)||this[i](t.toJSON(),e)},onReqAbort:function(t,e){this.parent(arguments),e.model.onSyncAbort(e.command)},onReqError:function(t,e,i,s){this.parent(arguments),s.model.onSyncError(i,s.command)},onReqLoad:function(t,e,i,s){this.parent(arguments),s.model.onSync(t,s.command)},onBeforeLoad:function(){}}}()),o(j("data.Model"),function(){function t(t,e){return e.attr("data-model-id",t.id),Object.keys(t.changes).forEach(function(t){e.find('[data-model-binding="'+t+'"]').html(this[t])},t.src),t}function e(t,e,i){var s=this.schema.property[i];return t[i]=s.store?e.toJSON():B.merge(e),t}var i=999;return{afterdefine:function(t){var e=t.prototype;(t.__proxy__=d(e.proxy,"proxy.ModelSync"))&&delete e.proxy,(t.__schema__=f(e.schema))&&delete e.schema},beforeinstance:function(t,e){e.proxy=t.__proxy__,e.schema=t.__schema__},constructor:function(t){this.parent(),this.changes=B.obj(),this.dom=B.obj(),this.raw=t,this.src=this.schema.coerceItem(t);var e=this.schema,s=this.src[e.mappings.id]||t[e.mappings.id];this.exists=!!s,this.id=s||"phantom-"+ ++i,this.exists?(B.len(t)-1||this.autoLoad===!1||this.sync(),this.set("id",s)):B.len(this.src)>0&&this.autoSync===!0&&this.sync()},extend:"Observer",module:V,proxy:null,schema:null,autoLoad:!0,autoSync:!1,dirty:{get:function(){return!!B.len(this.changes)},set:function(){return this.dirty}},changes:null,id:null,dom:null,exists:!1,raw:null,slc:null,src:null,suspendChange:0,suspendSync:0,destroy:function(t){t===!0&&this.parent(arguments),this.proxy.delete(this)},get:function(t){return this.src[t]||null},getBoundEl:function(t){return this.dom[I(t)?t:t.id]||null},revert:function(t){return I(t)?(t in this.changes&&(this.set(t,this.changes[t]),delete this.changes[t]),void 0):(Object.keys(this.changes).forEach(this.revert,this),void 0)},set:function(t,e,i){return T(t)?(w(e)&&(i=e),this.suspendChange||++this.suspendChange,Object.reduce(t,function(t,e,i){return t.onSet(i,e,!0)},this),!this.suspendChange||--this.suspendChange,i===!0||this.syncView(),this.broadcast("change"),void 0):(this.onSet(t,e,i),i===!0||this.syncView(),!this.dirty||this.autoSync===!1||this.sync(),void 0)},sync:function(){this.suspendSync||this.proxy.sync(this)},toJSON:function(){if(this.destroyed)return B.obj();var t=Object.reduce(this.src,e.bind(this),B.obj());return this.exists?t.id=this.id:delete t.id,t},bindView:function(t,e){switch(B.type(e)){case"element[]":break;case"htmlelement":e=N.$(e);break;default:if(!(e=t.$el.find(this.slc)).size)return}this.dom[t.id]=e.attr("data-model-id",this.id)},onDestroy:function(){this.parent(arguments),this.destroyed=!0,delete this.changes,delete this.dom,delete this.exists,delete this.id,delete this.raw,delete this.src},onSet:function(t,e){var i,s=this.schema,n=s.property;t in n&&(n[t].store?(this.src[t].load(e),this.suspendChange||this.broadcast("change"),this.broadcast("change:"+t)):(i=n[t].coerce(e),i!==this.src[t]&&(this.raw[t]=e,this.changes[t]=this.src[t],this.src[t]=i,this.suspendChange||this.broadcast("change"),this.broadcast("change:"+t,this.src[t],this.changes[t])))),t===s.mappings.id&&(this.id=this.src[t]||e,this.slc='[data-id="'+this.id+'"], [data-model-id="'+this.id+'"]')},onSync:function(t,e){return"delete"===e?this.destroy(!0):(t=this.schema.getItemRoot(t),t&&(B.copy(this.src,this.schema.coerceItem(t)),this.raw=t,"create"===e&&(this.id=this.src.id,this.exists=!!this.id),this.broadcast("sync",e).broadcast("change")),void 0)},onSyncAbort:function(t){this.broadcast("sync:abort",t)},onSyncError:function(t,e){this.broadcast("sync:error",e,t)},syncView:function(){Object.reduce(this.dom,t,this)}}}()),o(j("data.Node"),function(){function t(t,e){return e.attr("data-node-id",t.id),Object.keys(t.changes).forEach(function(t){e.find('[data-node-binding="'+t+'"]').html(this[t])},t.src),t}function e(t,e,i){return t[i]=B.merge(e),t}return{constructor:function(t,e){this.changes=B.obj(),this.dom=B.obj(),this.raw=e,this.schema=t,this.src=t.coerceItem(e);var i=this.src[t.mappings.id]||e[t.mappings.id];this.exists=!!i,this.set("id",i)},extend:Object,module:V,dirty:{get:function(){return!!B.len(this.changes)},set:function(){return this.dirty}},changes:null,id:null,dom:null,exists:!1,raw:null,schema:null,slc:null,src:null,get:function(t){return this.src[t]},getBoundEl:function(t){return this.dom[I(t)?t:t.id]||null},revert:function(t){return I(t)?(t in this.changes&&(this.set(t,this.changes[t]),delete this.changes[t]),void 0):(Object.keys(this.changes).forEach(this.revert,this),void 0)},set:function(t,e,i){if(T(t))return w(e)&&(i=e),Object.reduce(t,function(t,e,i){return t.set(i,e,!0)},this),i===!0||this.syncView(),void 0;var s,n=this.schema,a=n.property;this.raw[t]=e,t in a&&(s=a[t].coerce(e),s!==this.src[t]&&(this.changes[t]=this.src[t],this.src[t]=s)),t===n.mappings.id&&(this.id=this.src[t]||e,this.slc='[data-id="'+this.id+'"], [data-node-id="'+this.id+'"]'),i===!0||this.syncView()},toJSON:function(){var t=Object.reduce(this.src,e,B.obj());return this.exists?t.id=this.id:delete t.id,t},bindView:function(t,e){switch(B.type(e)){case"element[]":break;case"htmlelement":e=N.$(e);break;default:if(!(e=t.$el.find(this.slc)).size)return}this.dom[t.id]=e.attr("data-node-id",this.id)},syncView:function(){Object.reduce(this.dom,t,this)}}}()),!function(){function t(t,e){return t[e.id]=e,t}function e(t){return t instanceof i.Property?t:widgie.create("data.Schema.Property",t)}o(j("data.Schema"),{afterdefine:function(t){var e=t.prototype;t.__mappings__=e.mappings,t.__properties__=e.properties,delete e.mappings,delete e.properties},beforeinstance:function(t,e,i){var s=T(i[0]);T(t.__mappings__)&&(e.mappings=s?B.update(i[0].mappings||B.obj(),t.__mappings__):B.update(t.__mappings__),!s||delete i[0].mappings),"object"==typeof t.__properties__&&(e.properties=s?B.update(i[0].properties||B.obj(),t.__properties__):B.update(t.__properties__),!s||delete i[0].properties)},constructor:function i(i){x(i)&&(i={properties:i}),T(i)||(i=B.obj()),this.mappings=B.update(i.mappings||this.mappings||B.obj(),s),this.properties=(i.properties||this.properties).map(e,this),this.property=this.properties.reduce(t,B.obj())},extend:Object,module:V,mappings:null,properties:null,property:null,coerce:function(t,e){var i=this.prepare(t);return i.items=i.items.map(this[this.json===!0||e===!0?"coerceItem":"toNode"],this),i},coerceItem:function(t){var e=B.obj();return this.properties.invoke("process",B.update(this.getItemRoot(t)),e),e},getItemRoot:function(t){var e=this.mappings.item;return e&&e in t?t[e]:t},getRoot:function(t){if(!t)return[];var e=this.mappings.items,i=x(t)?t:e&&e in t?t[e]:t;return x(i)?i.slice():[]},prepare:function(t){var e,i,s;return t&&"object"==typeof t?(e=this.getRoot(t),s=this.mappings.total in t?t[this.mappings.total]:e.length,i=this.mappings.success in t?t[this.mappings.success]:!!s):(e=[],s=-1,i=!1),{items:e,success:i,total:s}},toNode:function(t){return V.data.Node.create(this,t)},valid:function(t){return Object.keys(t).every(function(e){return e in this&&this[e].valid(t[e])},this.property)}}),o(j("data.Schema.Property"),{constructor:function(t){switch(B.copy(this,t||{}),!this.cite&&this.id&&(this.cite=this.id),!this.id&&this.cite&&(this.id=this.cite),~this.id.indexOf(".")?(this.path=this.id.split("."),this._id=this.path.pop(),this.path=this.path.join(".")):(this._id=this.id,this.path=""),B.ntype(this.type)){case"function":break;case"string":null===this.default&&"object"!==this.type&&(this.default=n[this.type]),this.type=r[this.type]}switch(S(this.type)||L({instance:this,method:"constructor",message:"Invalid data.Schema.Property#type",name:L.code.DATA_SCHEMA_TYPE}),B.ntype(this.format)){case"function":case"string":break;default:this.format=B}this.fmt=a[B.ntype(this.format)]||this.fmt,this.schema=f(this.schema),"collection"==this.type.id&&(this.store=p(this.store))},extend:Object,module:V,cite:null,"default":null,format:null,id:null,schema:null,store:null,type:"object",_id:null,coerce:function(t,e,i){return this.fmt(t,this.format,e,i)},process:function(t,e){return this.assign(this.coerce(this.val(t,e),t,e),e)},valid:function(t){return this.store?!0:B.ntype(t)===this.type.id},value:B,assign:function(t,e){var i=B.bless(this.path,e);return i[this._id]=t,e},fmt:B,val:function(t,e){var i=this.value(Object.value(t,this.cite)||null,t,e);return i===this||i===A?null:i}});var i=c("data.Schema"),s=i.DEFAULT_MAPPINGS={id:"id",items:"items",success:"success",total:"total"},n={"boolean":!1,date:"now",number:0,string:""},a={"function":function(t,e,i,s){return e.call(this,this.type(t),i,s)},string:function(t,e){return this.type(t,e)}},r=i.TYPE={array:function(t){return this.schema?this.schema.coerce(t).items||[]:Array.isArray(t)?t:B.exists(t)?Array.coerce(t):[]},"boolean":function(t){return Boolean.coerce(t)},collection:function(t){return this.store.create({data:t})},date:function(t,e){if(C(t))return t;var i;if(e||(e=this.format),null!==t)switch(B.ntype(e)){case"string":i=N.date.coerce(t,e);break;case"function":i=e(t);break;default:i=new Date(t)}else i=0/0;return isNaN(+i)?"now"==this.default?new Date:new Date(+this.default):i},number:function(t){return Number(t)==t?Number(t):this.default},object:function(t){return this.schema?this.schema.coerceItem(t):t===A?this.default:t},string:function(t){return t+""==t?(t+"").trim():this.default}};Object.keys(r).forEach(function(t){this[t].id=t},r)}(),o(j("data.Store"),function(){function e(t){this.set(t.id,t)}function i(t,e){return t.view.ovalues.map(function(t){return[t.get(e),t]})}var s=c("data.Node"),n={date:function(t,e,i){return+i.get(t)===+e},"default":function(t,e,i){return i.get(t)===e},regexp:function(t,e,i){return e.test(i.get(t))},string:function(t,e,i){return(i.get(t)+"").toLowerCase()===e}},a={asc:function(t,e){return t[0]===e[0]?0:t[0]>e[0]?1:-1},desc:function(t,e){return t[0]===e[0]?0:t[0]<e[0]?1:-1}};return{constructor:function(t){this.mixin("observer",T(t)?t.observers:[]).parent(arguments)},extend:t.Source,mixins:{observer:"Observer"},module:V,data:null,id:null,proxy:null,schema:null,changes:{get:function(){return this.data.reduce(function(t,e){return!e.dirty||t.push(e),t},[])},set:function(){return this.changes}},dirty:{get:function(){return this.data.values.pluck("dirty").some($)},set:function(){return this.dirty}},size:{get:function(){return this.data.length},set:function(){return this.size}},view:{get:function(){return this.current||this.data},set:function(){return this.view}},loading:!1,current:null,stache:null,suspendChange:0,add:function(t,e){if(x(t))return this.suspendChange||++this.suspendChange,t.forEach(this.add,this),!this.suspendChange||--this.suspendChange,this.onChangeData(e);var i=this.onAdd(t);!i||this.onChangeData(e)},bindView:function(t){this.data.values.invoke("bindView",t)},byId:function(t){return T(t)?t instanceof s&&this.data.key(t)?t:this.data.get(t[this.schema.mappings.id])||this.data.get(t.id):this.data.get(t)||null},clear:function(t){this.data.clear(),t===!0||this.broadcast("clear"),this.onChangeData(t)},clearFilters:function(t){this.emptyStash(t)},commit:function(){},contains:function(t){return!!this.byId(t)},each:function(t,e){this.view.ovalues.forEach(t,e||this)},emptyStash:function(t){delete this.current,this.stache.length=0,t===!0||this.broadcast("empty:stash"),this.onChangeView(t)
},fetch:function(t,e){this.proxy&&(this.proxy.load(this.prepare(t),e),this.loading=this.proxy.loading)},filter:function(t,e){e||(e=this),this.updateView(this.view.ovalues.filter(function(i,s){return t.call(e,i,s,this)},this))},filterBy:function(t,e){this.filter((n[B.ntype(e)]||n.default).bind(this,t,e))},find:function(t,e){return e||(e=this),this.data.ovalues.find(function(i,s){return t.call(e,i,s,this)},this)},findAll:function(t,e){return e||(e=this),this.data.ovalues.filter(function(i,s){return t.call(e,i,s,this)},this)},first:function(){return this.getAt(0)},get:function(t){return T(t)?t instanceof s&&this.data.key(t)?t:this.data.get(t[this.schema.mappings.id])||this.data.get(t.id):this.byId(t)||this.getAt(t)||null},getAt:function(t){return this.data.ovalues[t>-1?t:this.data.length+t]||null},getBoundEls:function(t){return this.data.values.invoke("getBoundEl",t)},indexOf:function(t,e){return t=this.get(t),t?(e===!0?this.view:this.data).ovalues.indexOf(t):-1},last:function(){return this.getAt(-1)},load:function(t,e){t.success&&t.items?(this.add(t.items,!!e),!e||this.onChangeData(!1,e)):this.broadcast("load:empty",t,e)},map:function(t,e){return this.view.ovalues.map(t,e||this)},next:function(t){var e=this.indexOf(t,!0);return~e?this.view.ovalues[e+1]||null:null},prev:function(t){var e=this.indexOf(t,!0);return~e?this.view.ovalues[e-1]||null:null},reduce:function(t,e,i){return i||(i=this),this.view.ovalues.reduce(function(e,s){return t.call(i,e,s)},e)},remove:function(t,e){t=this.get(t),!t||!this.onRemove(t)||e===!0||this.onChangeData()},revert:function(t,e){return t?(t=this.get(t),t.dirty&&(t.revert(),e===!0||this.broadcast("revert",t).onChangeData()),void 0):(w(t)&&(e=t),t=this.changes,t.length&&(t.invoke("revert"),e===!0||this.broadcast("revert",t).onChangeData()),void 0)},setProxy:function(t){this.proxy&&(this.proxy.ignore("error","onLoadError",this).ignore("load","onLoad",this).ignore("loadstart","onLoadStart",this).ignore("timeout","onLoadError",this),delete this.proxy),I(t)&&(t={urlBase:t}),(this.proxy=d(t))&&(this.proxy.observe({error:"onLoadError",load:"onLoad",loadstart:"onLoadStart",timeout:"onLoadError",ctx:this}),this.broadcast("set:proxy"))},setSchema:function(t){(this.schema=f(t))&&this.broadcast("set:schema")},sort:function(t,e){this.updateView(this.view.ovalues.slice().sort(t.bind(e||this)))},sortBy:function(t,e){this.updateView(i(this,t).sort(a[(e+"").toLowerCase()]||a.asc).pluck(1))},stash:function(){this.current&&(this.stache.push(this.current.clone()),delete this.current,this.broadcast("stash"))},toJSON:function(){return this.view.ovalues.pluck("src")},undo:function(t){if(this.stache.length){(isNaN(t)||0>t)&&(t=0);var e=this.stache[t];this.stache.splice(0,t+1),this.current=e,this.onChangeView()}else delete this.current&&this.onChangeView()},updateView:function(i){this.stash(),this.current=t("Hash"),i.forEach(e,this.current),this.onChangeView()},onAdd:function(t){var e,i;return i=t instanceof s?t.schema===this.schema&&this.schema.valid(t.src)?t:s.create(this.schema,t.raw||t.src):s.create(this.schema,t),e=this.data.get(i.id),e?e.set(i.raw):this.data.set(i.id,i),i},onChangeData:function(t,e){this.suspendChange||(this.emptyStash(!0),t===!0||this.broadcast("change:data",e),this.proxy&&(this.loading=this.proxy.loading))},onChangeView:function(t){this.suspendChange||t===!0||this.broadcast("change:view")},onLoad:function(t,e,i,s,n){this.broadcast("load:complete",e,i,s,n).load(this.schema.coerce(e),n.options)},onLoadError:function(t,e,i,s,n){this.broadcast("load:error",e,i,s,n.options)},onLoadStart:function(){this.broadcast("load:start")},onRemove:function(t){var e=t.id;return!this.current||this.current.remove(e),this.stache.invoke("remove",e),this.data.remove(e)},prepare:function(t){return t},init:function(){this.parent(arguments),this.stache=[];var e=this.data,i=this.proxy,s=this.schema;switch(B.remove(this,"data","proxy","schema"),this.data=t("Hash"),this.setProxy(i).setSchema(s),B.ntype(e)){case"object":this.load(this.schema.coerce(e));break;case"array":this.add(e)}}}}()),o(j("data.Collection"),function(){function e(t){this.set(t.id,t)}function i(t,e){return t.view.ovalues.map(function(t){return[t.get(e),t]})}var s={date:function(t,e,i){return+i.get(t)===+e},"default":function(t,e,i){return i.get(t)===e},regexp:function(t,e,i){return e.test(i.get(t))},string:function(t,e,i){return(i.get(t)+"").toLowerCase()===e}},n={asc:function(t,e){return t[0]===e[0]?0:t[0]>e[0]?1:-1},desc:function(t,e){return t[0]===e[0]?0:t[0]<e[0]?1:-1}};return{constructor:function(t){this.mixin("observer",T(t)?t.observers:[]).parent(arguments)},extend:t.Source,mixins:{observer:"Observer"},module:V,data:null,id:null,model:null,proxy:null,schema:null,changes:{get:function(){return this.data.reduce(function(t,e){return!e.dirty||t.push(e),t},[])},set:function(){return this.changes}},dirty:{get:function(){return this.data.values.pluck("dirty").some($)},set:function(){return this.dirty}},size:{get:function(){return this.data.length},set:function(){return this.size}},view:{get:function(){return this.current||this.data},set:function(){return this.view}},loading:!1,current:null,stache:null,suspendChange:0,add:function(t,e){if(x(t))return this.suspendChange||++this.suspendChange,t.forEach(this.add,this),!this.suspendChange||--this.suspendChange,this.onChangeData(e);var i=this.onAdd(t);!i||this.onChangeData(e)},bindView:function(t){this.data.values.invoke("bindView",t)},byId:function(t){return T(t)?t instanceof this.model&&this.data.key(t)?t:this.data.get(t[this.model.__schema__.mappings.id])||this.data.get(t.id):this.data.get(t)||null},clear:function(t){this.data.clear(),t===!0||this.broadcast("clear"),this.onChangeData(t)},clearFilters:function(t){this.emptyStash(t)},commit:function(){},contains:function(t){return!!this.byId(t)},each:function(t,e){this.view.ovalues.forEach(t,e||this)},emptyStash:function(t){delete this.current,this.stache.length=0,t===!0||this.broadcast("empty:stash"),this.onChangeView(t)},fetch:function(t,e){this.proxy&&(this.proxy.load(this.prepare(t),e),this.loading=this.proxy.loading)},filter:function(t,e){e||(e=this),this.updateView(this.view.ovalues.filter(function(i,s){return t.call(e,i,s,this)},this))},filterBy:function(t,e){this.filter((s[B.ntype(e)]||s.default).bind(this,t,e))},find:function(t,e){return e||(e=this),this.data.ovalues.find(function(i,s){return t.call(e,i,s,this)},this)},findAll:function(t,e){return e||(e=this),this.data.ovalues.filter(function(i,s){return t.call(e,i,s,this)},this)},first:function(){return this.getAt(0)},get:function(t){return T(t)?t instanceof this.model&&this.data.key(t)?t:this.data.get(t[this.model.__schema__.mappings.id])||this.data.get(t.id):this.byId(t)||this.getAt(t)||null},getAt:function(t){return this.data.ovalues[t>-1?t:this.data.length+t]||null},getBoundEls:function(t){return this.data.values.invoke("getBoundEl",t)},indexOf:function(t,e){return t=this.get(t),t?(e===!0?this.view:this.data).ovalues.indexOf(t):-1},last:function(){return this.getAt(-1)},load:function(t,e){var i=this.readResponse(t);i.success&&i.items?(this.add(i.items,!!e),!e||this.onChangeData(!1,e)):this.broadcast("load:empty",i,e)},map:function(t,e){return this.view.ovalues.map(t,e||this)},next:function(t){var e=this.indexOf(t,!0);return~e?this.view.ovalues[e+1]||null:null},prev:function(t){var e=this.indexOf(t,!0);return~e?this.view.ovalues[e-1]||null:null},reduce:function(t,e,i){return i||(i=this),this.view.ovalues.reduce(function(e,s){return t.call(i,e,s)},e)},remove:function(t,e){t=this.get(t),!t||!this.onRemove(t)||e===!0||this.onChangeData()},readResponse:function(t){return this.model.__schema__.prepare(t)},revert:function(t,e){return t?(t=this.get(t),t.dirty&&(t.revert(),e===!0||this.broadcast("revert",t).onChangeData()),void 0):(w(t)&&(e=t),t=this.changes,t.length&&(t.invoke("revert"),e===!0||this.broadcast("revert",t).onChangeData()),void 0)},setModel:function(t){(this.model=u(t))&&this.broadcast("set:model")},setProxy:function(t){this.proxy instanceof c("proxy.Ajax")&&(this.proxy.ignore("error","onLoadError",this).ignore("load","onLoad",this).ignore("loadstart","onLoadStart",this).ignore("timeout","onLoadError",this),delete this.proxy),I(t)&&(t=d(t)||{urlBase:t}),(this.proxy=d(t))&&(this.proxy.observe({error:"onLoadError",load:"onLoad",loadstart:"onLoadStart",timeout:"onLoadError",ctx:this}),this.broadcast("set:proxy"))},sort:function(t,e){this.updateView(this.view.ovalues.slice().sort(t.bind(e||this)))},sortBy:function(t,e){this.updateView(i(this,t).sort(n[(e+"").toLowerCase()]||n.asc).pluck(1))},stash:function(){this.current&&(this.stache.push(this.current.clone()),delete this.current,this.broadcast("stash"))},toJSON:function(){return this.view.ovalues.invoke("toJSON")},undo:function(t){if(this.stache.length){(isNaN(t)||0>t)&&(t=0);var e=this.stache[t];this.stache.splice(0,t+1),this.current=e,this.onChangeView()}else delete this.current&&this.onChangeView()},updateView:function(i){this.stash(),this.current=t("Hash"),i.forEach(e,this.current),this.onChangeView()},onAdd:function(t){var e,i;return t instanceof this.model||(i=this.model.create(t)),(e=this.data.get(i.id))?e:(this.data.set(i.id,i),i.observe({"before:destroy":"remove",change:"onChangeData",ctx:this}),i)},onChangeData:function(t,e){this.suspendChange||(this.emptyStash(!0),t===!0||this.broadcast("change:data",e),this.proxy&&(this.loading=this.proxy.loading))},onChangeView:function(t){this.suspendChange||t===!0||this.broadcast("change:view")},onLoad:function(t,e,i,s,n){this.broadcast("load:complete",e,i,s,n).load(e,n.options)},onLoadError:function(t,e,i,s,n){this.broadcast("load:error",e,i,s,n.options)},onLoadStart:function(){this.broadcast("load:start")},onRemove:function(t){var e=t.id;return!this.current||this.current.remove(e),this.stache.invoke("remove",e),this.data.remove(e)},prepare:function(t){return B.update(t||B.obj(),this.defaultData)},init:function(){this.parent(arguments),this.stache=[];var e=this.data,i=this.model,s=this.proxy;switch(B.remove(this,"data","model","proxy"),this.data=t("Hash"),this.setModel(i).setProxy(s),T(this.defaultData)||(this.defaultData=B.obj()),B.ntype(e)){case"object":this.load(e);break;case"array":this.add(e)}}}}()),o(j("mixins.DataProcessor"),{constructor:function(){},extend:Object,module:V,parse:function(t,e){return t?N.tpl.parse(t,this.prepare(e)):""},prepare:function(t){var e={"@":this};return"object"==typeof t?B.copy(e,this.process(t),!0):e},process:function(t){switch(B.type(t)){case"object":case"nullobject":return"items"in t?t.items.map(this.processItem,this):t;case"array":return{items:t.map(this.processItem,this)};case R+"-data-store":return{items:t.view.ovalues.map(this.processItem,this)}}return{items:[]}},processItem:function(t){return t.toJSON?t.toJSON():t.src||t}}),o(j("mixins.DataView"),function(){function t(t){return B.remove(n(t),this),t}function e(t,e){return delete n(t)[e],t}function i(t,e,i,s){if(!t.ready)return N.$();var a=n(t),r=a[s];return"element[]"==B.type(r)?r:a[s]=t.$el[e](i)}function s(t){return"#"+t.id}function a(t,e,i){return t[i]=0===i.indexOf("data-")?this.id+"::"+e:e,t}function r(t,e,i){return t[i]="",t}var o="selectables selected unselected".split(" "),c=o.slice(1),h=t.bind(o),l=t.bind(c),u={multiple:!0,none:!0,single:!0},d={"data-click":"handleItemClick","data-mouseenter":"handleItemOver","data-mouseleave":"handleItemOut",role:"button"};return{extend:Object,module:V,selectables:{get:function(){return i(this,"find",this.slcItem,"selectables")}},selected:{get:function(){return i(this,"find",this.slcItemSelected,"selected")}},selectionType:{get:function(){return n(this).selectionType},set:function(t){t=(t+"").toLowerCase();var e,i=n(this),s=i.selectionType;if(s===t||!(t in u))return s;if(i.selectionType=t,this.ready){switch(t){case"none":this.deselectAll();break;case"single":this.selected.length>1&&(e=this.selected[0],this.select(e))}this.broadcast("change:selectiontype",this,t,s)}return t}},unselected:{get:function(){return i(this,"not",this.slcItemSelected,"unselected")}},deselect:function(t){!this.interactive||!this.isSelected(t)||this.broadcast("before:deselect:item",t=this.getItem(t))===!1||this.onDeselect(t).broadcast("deselect:item",t)},deselectAll:function(t){if(this.interactive){if(t===!0)return this.onDeselectAll();e(this,"selected"),!this.selected.length||this.broadcast("before:deselect:all")===!1||this.onDeselectAll().broadcast("deselect:all")}},getItem:function(t){switch("element[]"==B.type(t)&&(t=t[0]),B.type(t)){case"string":t=this.$el.find(t)[0]||this.$el.find("#"+t)[0]||null;break;case"htmlelement":t=this.$el.contains(t)?t:null;break;default:return null}return t?N.$(t):null},invertSelection:function(){!this.interactive||this.broadcast("before:select:inverse")===!1||this.onInvertSelection().broadcast("select:inverse")},isSelected:function(t){return(t=this.getItem(t))?t.hasClass(this.clsItemSelected):!1},refreshView:function(){var t=this.selected;switch(h(this),this.selectionType){case"multiple":case"single":this.selectables.attr(Object.reduce(B.merge(d),a.bind(this),B.obj())),t.length&&("multiple"===this.selectionType?Array.coerce(this.$el.find(Array.coerce(t).map(s).join(", "))).map(this.select,this):this.select(this.$el.find(t[0])));break;default:this.selectables.attr(Object.reduce(B.merge(d),r.bind(this),B.obj()))}},select:function(t){!this.interactive||"none"===this.selectionType||!(t=this.getItem(t))||this.isSelected(t)||this.broadcast("before:select:item",t)===!1||this.onSelect(t).broadcast("select:item",t)},selectAll:function(t){if(this.interactive&&"multiple"===this.selectionType){if(t===!0)return this.onSelectAll();e(this,"unselected"),!this.unselected.length||this.broadcast("before:select:all")===!1||this.onSelectAll().broadcast("select:all")}},toggle:function(t){(t=this.getItem(t))&&this[this.isSelected(t)?"deselect":"select"](t)},onDeselect:function(t){l(this),t.removeClass(this.clsItemSelected),l(this)},onDeselectAll:function(){l(this),this.selected.removeClass(this.clsItemSelected),l(this)},onInvertSelection:function(){var t=this.clsItemSelected,e=this.selected,i=this.unselected;l(this),e.removeClass(t),i.addClass(t),l(this)},onSelect:function(t){l(this),"single"===this.selectionType&&this.deselect(this.selected),t.addClass(this.clsItemSelected),l(this)},onSelectAll:function(){l(this),this.unselected.addClass(this.clsItemSelected),l(this)},registerEvents:function(){this.observe({"after:render":"refreshView","refs:applied":"refreshView"})},init:function(){this.selectionType||(this.selectionType="none"),["","collapsed","focused","over","selected"].join(" item-").trim().split(" ").map(this.prefixClsSlc,this)},handleItemClick:function(t){var e=N.$(t.currentTarget).closest(this.slcItem);e.length&&(this.broadcast("item:click",e,t),"none"!==this.selectionType&&this.toggle(e))},handleItemOut:function(t){var e=N.$(t.currentTarget).closest(this.slcItem);!e.length||!e.hasClass(this.itemOver)||this.broadcast("item:out",e.removeClass(this.clsItemOver),t)},handleItemOver:function(t){var e=N.$(t.currentTarget).closest(this.slcItem);!e.length||e.hasClass(this.itemOver)||this.broadcast("item:over",e.addClass(this.clsItemOver),t)}}}()),o(j("mixins.ClsSlc"),{extend:Object,module:V,clsList:"active collapsed focused disabled expanded hidden item",init:function(){switch(this.slcBase="."+this.clsBase,B.ntype(this.clsList)){case"string":this.clsList=this.clsList.split(" ");case"array":this.clsList.map(this.prefixClsSlc,this)}},prefixClsSlc:function(t){var e=t.split("-").map(y).join(""),i="-"+t;this["cls"+e]=this.clsBase+i,this["slc"+e]=this.slcBase+i}}),o(j("mixins.DOMRefs"),function(){var t="$1",e=/^\$?el(.*)/;return{extend:Object,module:V,selectors:null,slcRef:"[data-ref]",refs:null,suspendApply:0,getRef:function(i,s){return s=Boolean.coerce(s),i=(i+"").replace(e,t),i=(s?"":"$")+"el"+i.split("-").map(y),this[i]||null},applySelectors:function(){this.suspendApply||(this.applyDOMRefs(),!T(this.refs)||Object.reduce(this.refs,this.applySelector,this),this.refs.focus||this.elFocus||(this.$elFocus=this.$el,this.elFocus=this.el),this.broadcast("refs:applied"))},unapplySelectors:function(){!T(this.refs)||Object.reduce(this.refs,this.unapplySelector,this),this.broadcast("refs:unapplied")},updateEl:function(t,e){!this.interactive||!(t=this.getRef(t))||this.broadcast("before:update:element",t,e)===!1||this.onUpdateEl(t,e).broadcast("update:element",t)},onUpdateEl:function(t,e){t.html(e)},applyDOMRef:function(t,e){switch(B.type(t)){case"element[]":break;case"htmlelement":t=N.$(t);break;case"string":t=this.$el.find(t);break;default:return}"string"!=typeof e&&(e=t.data("ref")),t&&t.length&&(e="el"+y(e),this["$"+e]=t,this[e]=this["$"+e][0])},applyDOMRefs:function(){Array.coerce(this.$el.find(this.slcRef)).map(this.applyDOMRef,this)},applySelector:function(t,e,i){return t.applyDOMRef(e,i)},init:function(){this.prepareRefs(),T(this.refs)||(this.refs={}),this.slcFocus&&(this.refs.focus=this.slcFocus,delete this.slcFocus),!T(this.selectors)||B.copy(this.refs,this.selectors,!0)},prepareRefs:B.noop,registerEvents:function(){this.observe({destroy:"unapplySelectors",render:"applySelectors",update:"applySelectors"})},unapplySelector:function(t,e,i){return i="el"+y(i),B.remove(this,[i,"$"+i]),t}}}()),o(j("mixins.Renderer"),{extend:Object,module:V,slcCt:"body",tpl:e+".component",dead:{get:function(){return this.destroyed||this.destroying}},destroyed:!1,destroying:!1,ready:{get:function(){return this.rendered&&!this.dead}},rendered:!1,rendering:!1,$ct:null,$el:null,ct:null,el:null,suspendUpdate:0,render:function(t){this.ready||this.dead||this.broadcast("before:render")===!1||(this.rendering=!0,this.assignContainer(t).onRender().afterRender(),this.rendering=!1)},prepareFragment:function(t,e){var i;switch(B.type(t)){case"object":case"nullobject":case"array":case R+"-data-store":i=this.parse(e,t);break;case"string":break;case"null":i="";break;case"htmlelement":case"documentfragment":return t;case"htmlcollection":case"element[]":i=t;break;default:return null}return I(i)&&(i=i.trim()),this.fragmentalize(i?i:"")},toElement:function(t,e){return N.$(this.parse(t,e))},afterRender:function(){this.broadcast("after:render"),!w(this.active)||this[(this.active===!0?"":"de")+"activate"](),this.focusable!==!1&&(s(this.$elFocus,"blur",this.id+"::blur"),s(this.$elFocus,"focus",this.id+"::focus"),this.focused===!0&&(this.focused=!1,this.focus()))},onAppend:function(t){this[this.updateTarget][0].appendChild(t)},onDestroy:function(){this.rendered&&(this.rendered=!1,this.$el.remove(),B.remove(this,"$ct $el ct el".split(" ")))},onRender:function(){this.createDOM(),this.$el.appendTo(this.ct),this.rendered=!0,this.broadcast("render"),this.updateTarget in this||(this.updateTarget=this.$elCt?"$elCt":"$el")},onUpdate:function(t){this[this.updateTarget].html(null)[0].appendChild(t)},assignContainer:function(i){var s=B.type(i);B.exists(i)&&("element[]"==s?this.$ct=i:"string"==s||"htmlelement"==s?this.$ct=N.$(i):t.is(i,e+".Box")?this.$ct=i[i.prop.ctItems]||i.$elCt||i.$el:this.slcCt&&(this.$ct=N.$(this.slcCt))),this.$ct&&(this.ct=this.$ct[0])},createDOM:function(){this.$el=this.toElement(this.tpl,null).attr("id",this.id).data("transitionend","afterTransition"),this.el=this.$el[0],!this.$el.hasClass(this.clsDefault)||this.$el.addClass(this.clsDefault),~this.el.firstElementChild.className.indexOf(this.clsBase+"-ct")&&(this.elCt=this.el.firstElementChild,this.$elCt=N.$(this.elCt))},fragmentalize:function(t){var e=M.createDocumentFragment();return N.$(t).appendTo(e),e},init:function(){this.tpl=N.tpl.create(this.tpl)}}),o(j("mixins.BoxRenderer"),{extend:j("mixins.Renderer"),module:V,autoRender:!0,tpl:e+".box",onRemove:function(t){t.$el.remove()},onRender:function(){this.parent().renderItems()},adopt:function(t,e,i){this.rendered&&this.autoRender!==!1&&(t.render(this[this.$_items]).$el.css("display","none"),!e||t.$el.insertBefore(this.items[i>=0?i:this.items.length+i].el),t.$el.css("display",""))},destroyItem:function(t){return t.destroy()},renderItem:function(t){return t.rendered&&this.el.contains(t.el)?t:t.render(this[this.$_items])},renderItems:function(){!this.items.length||this.items.map(this.renderItem,this)}}),o(j("mixins.Validation"),{extend:Object,module:V,allowDecimals:!0,max:Number.POSITIVE_INFINITY,min:Number.NEGATIVE_INFINITY,pattern:null,required:!1,isValid:function(t){return V.Validate[this.inputType].valid(this,t)},validate:function(t){var e=this.value,i=this.isValid(e)&&this.onValidate(e);return t===!0||this.broadcast("validate").broadcast((i?"":"in")+"valid"),this.interactive&&(this.$el.removeClass(this.clsValid).removeClass(this.clsInvalid),t!==!0?this.$el.addClass(this["cls"+(i?"Valid":"Invalid")]):""!=this.$elField.val()||this.$el.addClass(this["cls"+(i?"Valid":"Invalid")])),i},onValidate:function(t){return this.required!==!0||V.Validate[this.inputType].minmax(this,t)},init:function(){},registerEvents:function(){this.observe("change","validate",this)}}),o(j("layout.Layout"),{constructor:function(t){B.copy(this,t||{}),this.afterLayout_=this.afterLayout.callback({ctx:this,delay:50}),this.cmp.rendered?this.init():this.cmp.once("after:render","init",this)},extend:Object,$el:null,cmp:null,disabled:!1,el:!1,items:null,slcItem:null,disable:function(){this.disabled=!0},enable:function(){this.disabled=!1},forceLayout:function(){this.layout(!0)},layout:function(t){return t=t===!0,this.cmp&&this.cmp.rendered&&!this.el&&this.init(),this.disabled||this.busy?void 0:this.refresh(t).beforeLayout(t)===!1?(this.busy=!1,void 0):(this.onLayout(t).afterLayout_(t),void 0)},afterLayout:function(){this.busy=!1},beforeLayout:function(){this.busy=!0},onLayout:function(){},refresh:function(){},sync:function(){},init:function(){var t=this.cmp,e=t.el;this.$el=t.$el,this.el=e,this.slcItem=t.slcItem,this.elOffset=/absolute|relative/.test(P.getComputedStyle(e,null).position)?e:e.offsetParent,t.observe({"change:dom":"forceLayout",ctx:this,options:{delay:200}}),!t.rendered||!t.active||this.layout()}}),o(j("Component"),{constructor:function(){this.parent(arguments).mixin("observer",[this.__config__.observers]).mixin("processor").registerEvents()},extend:t.Source,mixins:{clslc:e+".mixins.ClsSlc",observer:"Observer",processor:e+".mixins.DataProcessor",domrefs:e+".mixins.DOMRefs",renderer:e+".mixins.Renderer"},module:V,bound:null,cls:null,clsAnim:"w-anim",clsBase:"w-cmp",clsDefault:"w-cmp",focusable:!0,html:null,layout:null,slcFocus:null,tagName:"div",updateTarget:"$elCt",collapsed:{get:function(){return this.ready&&this.$el.hasClass(this.clsCollapsed)},set:function(t){return t=!!t,this.collapsed!==t&&this[t?"collapse":"expand"](),t}},visible:{get:function(){return this.ready&&!(this.$el.hasClass(this.clsHidden)||!this.$el.displayed())},set:function(t){return t=!!t,this.visible!==t&&this[t?"show":"hide"](),t}},active:null,focused:!1,disabled:!1,interactive:{get:function(){return this.ready&&this.visible&&!this.disabled}},id:null,activate:function(){this.active===!0||!this.interactive||this.broadcast("before:activate")===!1||this.onActivate().broadcast("activate")},append:function(t,e){this.dead||(this.rendered||this.render(),t===A||this.disabled||this.broadcast("before:append",t,e)===!1||this.onAppend(t,e||this.tplContent))},blur:function(t){!this.interactive||this.focusable===!1||!this.focused||this.broadcast("before:blur",t)===!1||this.onBlur().broadcast("blur",t)},collapse:function(){this.collapsed||!this.interactive||this.broadcast("before:collapse")===!1||this.onCollapse().broadcast("collapse")},deactivate:function(){this.active===!1||!this.interactive||this.broadcast("before:deactivate")===!1||this.onDeactivate().broadcast("deactivate")},destroy:function(){!this.interactive||this.mixin("observer")},disable:function(){this.disabled||this.broadcast("before:disable")===!1||this.onDisable().broadcast("disable")},enable:function(){!this.disabled||this.broadcast("before:enable")===!1||this.onEnable().broadcast("enable")},expand:function(){!this.collapsed||!this.interactive||this.broadcast("before:expand")===!1||this.onExpand().broadcast("expand")},focus:function(t){!this.interactive||this.focusable===!1||this.focused||this.broadcast("before:focus",t)===!1||this.onFocus().broadcast("focus",t)},hide:function(){this.rendered||this.render(),!this.visible||!this.interactive||this.broadcast("before:hide")===!1||this.onHide()},load:function(t){this.suspendApply||++this.suspendApply,this.disabled||this.broadcast("before:load",t)===!1||(this.store.fetch(t),this.broadcast("load:start",t))},loadAppend:function(t){this.suspendApply||++this.suspendApply,this.disabled||this.broadcast("before:load",t)===!1||(this.store.fetch(t,{append:!0}),this.broadcast("load:start",t))},refreshView:function(t,e){this[T(e)&&e.append===!0?"append":"update"](this.store.toJSON()),this.store.findAll(function(t){return!this.has(t.id)},this.store.view).invoke("getBoundEl",this).invoke("remove")},replaceCached:function(){!this.bound||this[this.updateTarget].find(".replace-cached").map(this._replaceCached,this)},show:function(){this.rendered||this.render(),!this.ready||this.visible||this.broadcast("before:show")===!1||this.onShow()},update:function(t,e){this.dead||(this.rendered||this.render(),this.suspendUpdate||(t&&t!==this||!this.store||(t=this.store),t===A||this.disabled||this.broadcast("before:update",t,e)===!1||this.onUpdate(t,e||this.tplContent)))},updateBindings:function(){this.store.bindView(this),this.bound=this.store.data.aggregate(this.bound||B.obj(),this._updateBindings,this)},afterActivate:function(){this.broadcast("after:activate")},afterAppend:function(){this[this.updateTarget].find(".replace-cached").remove(),!this.store||this.replaceCached().updateBindings(),this.broadcast("append").broadcast("change:dom")},afterCollapse:function(){this.broadcast("after:collapse")},afterDeactivate:function(){this.broadcast("after:deactivate")},afterExpand:function(){this.broadcast("after:expand")},afterHide:function(){this.broadcast("after:hide")},afterShow:function(){this.broadcast("after:show")},afterUpdate:function(){!this.store||this.replaceCached().updateBindings(),this.broadcast("update").broadcast("change:dom")},afterTransition:function(){!S(this[this.afterEvent])||this[this.afterEvent](),delete this.afterEvent},onActivate:function(){this.afterEvent="afterActivate",this.active=!0,this.$el.addClass(this.clsActive)},onAppend:function(t,e){var i=this.prepareFragment(t,e);!i||this.mixin("renderer",[i]).afterAppend()},onBlur:function(){this.focused=!1,this.$el.removeClass(this.clsFocused),!this.elFocus||this.elFocus.blur()},onCollapse:function(){this.ready&&(this.afterEvent="afterCollapse",this.$el.addClass(this.clsCollapsed))},onDeactivate:function(){this.afterEvent="afterDeactivate",this.active=!1,this.$el.removeClass(this.clsActive)},onDestroy:function(){g(this),this.mixin("renderer")},onDisable:function(){this.disabled=!0,!this.ready||this.$el.addClass(this.clsDisabled)},onEnable:function(){this.disabled=!1,!this.ready||this.$el.removeClass(this.clsDisabled)},onExpand:function(){this.ready&&(this.afterEvent="afterExpand",this.$el.removeClass(this.clsCollapsed))},onFocus:function(){this.focused=!0,this.$el.addClass(this.clsFocused),!this.elFocus||this.elFocus.focus()},onHide:function(){this.afterEvent="afterHide",this.$el.addClass(this.clsHidden)},onRender:function(){this.store&&(this.store.size?this.once("after:render",this.update,this):this.load()),this.mixin("renderer"),!this.disabled||this.disable(),this.hidden===!0&&(this.hide(),delete this.hidden)},onShow:function(){this.afterEvent="afterShow",this.$el.removeClass(this.clsHidden)},onUpdate:function(t,e){var i=this.prepareFragment(t,e);!i||this.mixin("renderer",[i]).afterUpdate()},registerEvents:function(){this.mixin("dataview").mixin("domrefs"),this.once("before:render","initLayout",this),!this.store||this.store.observe({"change:data":"refreshView","change:view":"refreshView",ctx:this})},_replaceCached:function(t){var e,i=t.getAttribute("data-replace-id"),s=t.parentNode,n=this.bound[i];n?(e=N.$(t).data(),delete e.replaceId,s.replaceChild(n.data(e)[0],t)):s.removeChild(t)},_updateBindings:function(t,e,i){var s=e.getBoundEl(this.id);return s&&(t[i]=s),t},init:function(){this.parent().mixin("clslc").mixin("dataview").mixin("domrefs").mixin("renderer").initStore(),this.tplContent&&(this.tplContent=N.tpl.create(this.tplContent)||null),this.updateTarget||(this.updateTarget="$elCt"),O.include(this)},initConfig:function(t){return t=this.parent(arguments),this.id=this.id||t.id||this.clsBase+"-"+ ++c(B.type(this)).count,delete t.id,t},initLayout:function(){if(!(this.layout instanceof c("layout.Layout")))switch(B.type(this.layout)){case"string":var t=c(this.layout);t.prototype instanceof c("layout.Layout")&&(this.layout=t.create({cmp:this}));break;case"object":this.layout.cmp=this,this.layout=r(this.layout);break;default:this.layout=null}},initStore:function(){var t=this.store;switch(B.type(t)){case R+"-data-store":break;case"object":case"nullobject":this.store=widgie.create("data.Store",t)}},onAction:function(t,e){S(this[t])&&this[t](e)},syncSize:function(){}}),c("Component").count=999,B.defs(V,{Mgr:{value:O=t(e+".TypedHash",{Type:V.Component})},get:O.get.bind(O)},"r"),o(j("Box"),{constructor:function(){this.parent(arguments).initItems(this.items)},extend:j("Component"),mixins:{dataview:B.obj(),renderer:e+".mixins.BoxRenderer"},module:V,$_items:"$elCt",clsBase:"w-box",tpl:e+".box",add:function(t){return arguments.length>1&&isNaN(arguments[1])&&(t=Array.coerce(arguments)),x(t)?(this.suspendEvents(),t=t.map(this.add,this),this.resumeEvents().broadcast("add",t),t):this.broadcast("before:add",t)!==!1&&(t=this.onAdd(t))?(this.broadcast("add",t),t):null},clear:function(t){this.items.length&&this.ready&&!this.disabled&&this.broadcast("before:clear")!==!1&&(t===!0&&this.suspendEvents(),this.onClear().resumeEvents().broadcast("clear"))},contains:function(t){return t=this.get(t),t&&t.parentBox===this},get:function(t){if(this.items.length)switch(B.type(t)){case"event":t=t.currentTarget;case"element[]":case"htmlelement":t=N.$(t).data("id");case"number":case"string":return this.items[t]||this.map[t]||this.map[this.id+"-"+t]||null;default:return B.got(t,"id","cmpId")?this.get(t.id)||this.get(this.id+"-"+t.cmpId):null}return null},insert:function(t,e){return this.broadcast("before:add",e,t)===!1?null:(e=this.onAdd(e,t),this.broadcast("add",e),e)},loadItems:function(t,e){"string"==typeof t&&(t={url:t}),t.success=this.onLoadItems.bind(this,e),this.disabled||this.broadcast("before:load:items",t)===!1||this.broadcast("load:items:start",N.xhr(t))},remove:function(t,e){return t&&(t=this.get(t))&&this.broadcast("before:remove",t)!==!1?(this.onRemove(t),e!==!0||t.dead||t.destroy(),this.broadcast("remove",t),void 0):null},onAdd:function(t,e){var i=this.get(t);return!i||!t.parentBox||t.parentBox.remove(i),(t=this.lookup(t))?(this.adopt(t,e),t.observe("destroy","onRemove",this),t):null},onClear:function(){for(;this.items.length;)this.remove(this.items[0],!0)},onRemove:function(t){B.remove(this.items,t),delete this.map[t.id],this.mixin("renderer",arguments),t.parentBox===this&&delete t.parentBox},onRender:function(){this.parent()},adopt:function(t,e){var i="number"==B.type(e);this.map[t.id]=t,!t.parentBox||t.parentBox.remove(t,!1),t.parentBox=this,this.mixin("renderer",[t,i,e]),i?this.items.splice(e,0,t):this.items.push(t)},applyDefaults:function(t){return B.copy(t,this.defaults,!0)},init:function(){this.parent(),T(this.defaults)||(this.defaults={})},initItems:function(t){switch(this.items=[],this.map=B.obj(),B.ntype(t)){case"array":this.add(t);break;case"string":case"object":this.loadItems(t,!1)}},lookup:function(i){return I(i)&&(i=O.get(i)),T(i)&&!i.id&&i.cmpId&&(i.id=this.id+"-"+i.cmpId),T(i)||L({cmp:this,item:i,message:"Incorrect Type: cannot add item - "+JSON.stringify(i)+"  to "+this.id,method:"lookup",name:L.code.BOX_ITEM_LOOKUP}),t.is(this.applyDefaults(i),e+".Component")?i:r(i)},onLoadItems:function(t,e){t===!0||this.clear(!0),!(!x(e)||!T(e))||this.add(e),this.broadcast("load:items:complete")
}}),c("Box").count=999,o(j("Form"),function(){function t(t,e){return t[e.name||e.cmpId||e.id]=e.value,t}return{constructor:function(){this.parent(arguments)},extend:e+".Box",module:V,async:!0,clsBase:"w-form",clsDefault:"w-form",proxy:null,valid:{get:function(){return this.fields.pluck("valid").every(B)}},value:{get:function(){return this.fields.reduce(t,B.obj())}},reset:function(){!this.interactive||this.broadcast("before:reset")===!1||this.onReset().broadcast("reset")},submit:function(){if(this.interactive){var t=this.valid;return t?(this.onValid().broadcast("before:submit")===!1||this.onSubmit().broadcast("submit"),void 0):(this.onInvalid(),void 0)}},afterRender:function(){this.parent(arguments),s(this.$el,"keyup",this.id+"::onKeyPress"),this.async===!1&&this.proxy&&(this.$el.attr({action:this.proxy.urlBase,method:this.proxy.method}),s(this.$el,"submit",this.id+"::handleSubmit"))},onAdd:function(t){(t=this.parent(arguments))&&(t instanceof c("Field")&&this.fields.push(t.observe("dom:blur",this.onTab,this)),t.relayEvents(this,"change","validate"))},onChange:function(){},onInvalid:function(){this.$el.removeClass(this.clsValid).addClass(this.clsInvalid)},onLoad:function(){console.log("load: ",this,arguments)},onLoadError:function(){console.log("loadend: ",this,arguments)},onLoadStart:function(){console.log("loadstart: ",this,arguments)},onRemove:function(t){t.parentBox===this&&B.remove(this.fields,t),this.parent(arguments)},onReset:function(){this.$el.removeClass(this.clsInvalid).removeClass(this.clsValid),this.fields.invoke("reset")},onSubmit:function(){this.async===!1?this.el.submit():this.proxy&&this.proxy.load(this.value)},onTab:function(t,e){if(e){var i=this.fields.indexOf(t);~i&&(i+=e.shiftKey===!0?-1:1,!this.fields[i]||this.fields[i].focus())}},onValid:function(){this.$el.removeClass(this.clsInvalid).addClass(this.clsValid)},onValidate:function(){},handleSubmit:function(t){this.async===!1&&this.valid||t.stop("11")},onKeyPress:function(t){var e=N.$.event.KEY_CODE;(t.which===e.ENTER||t.which===e.RETURN)&&this.submit()},init:function(){this.clsList+=" invalid valid",this.fields=[],this.async===!1&&(this.tagName="form"),this.parent(arguments).initProxy()},initProxy:function(){I(this.proxy)&&(this.proxy={urlBase:this.proxy}),(this.proxy=d(this.proxy))&&this.proxy.observe({error:"onLoadError",load:"onLoad",loadstart:"onLoadStart",timeout:"onLoadError",ctx:this})},registerEvents:function(){this.parent(arguments).observe({change:"onChange",validate:"onValidate",ctx:this})}}}()),o(j("Field"),function(){return{constructor:function(){this.parent(arguments)},extend:e+".Component",mixins:{validation:e+".mixins.Validation"},module:V,clsBase:"w-field",errorMsg:null,format:null,inputType:null,multiLine:!1,name:null,toolTip:null,tpl:R+".field",watchInterval:10,label:{get:function(){return n(this).label},set:function(t){return n(this).label=t,this.ready&&this.$elLabel.html(n(this).label),this.label}},valid:{get:function(){return this.validate(!0)}},value:{get:function(){return n(this).value},set:function(t){var e=n(this),i=this.rawToVal(t);return this.valToRaw(i),B.empty(t)&&!B.empty(e.value)?(e.val_prev=e.value,e.value=A,this.broadcast("change",e.value,e.val_prev)):i!==e.value&&(this.isValid(i)?(e.val_prev=e.value,e.value=i,this.ready&&(this.$elField.val(this.valToRaw(i)),this.broadcast("change",i,e.val_prev))):this.ready&&(this.$elField.val(this.valToRaw(e.value)),this.broadcast("change",e.value,e.val_prev))),e.value}},_iid:null,_inputType:null,$elField:null,$elLabel:null,elField:null,elLabel:null,clear:function(){!this.interactive||this.broadcast("before:clear")===!1||this.onClear().broadcast("clear")},reset:function(){!this.interactive||this.broadcast("before:reset")===!1||this.onReset().broadcast("reset")},rawToVal:function(t){return V.Validate[this.inputType].val(this,t)},valToRaw:function(t){return V.Validate[this.inputType].raw(this,t)},afterRender:function(){switch(this.parent(arguments),this.$elField.val(this.value),this.inputType){case"checkbox":case"radio":this.$elField.attr("data-click",this.id+"::onFocus")}},onBlur:function(){this.parent(arguments).watchStop().validate()},onClear:function(){this.$elField.val(""),this.handleChange()},onFocus:function(){this.parent(arguments).watchStart().validate()},onReset:function(){this.$elField.val(n(this).val_initial),this.handleChange()},handleBlur:function(t){!t||t.target!==this.elFocus||this.broadcast("dom:blur",t)},handleChange:function(){this.value=this.$elField.val()},handleFocus:function(t){!t||t.target!==this.elFocus||this.broadcast("dom:focus",t)},init:function(){this.clsList+=" invalid valid",this.slcFocus="."+this.clsBase+"-input",this.name=this.name||this.cmpId||this.id,this.handleChange_=this.handleChange.bind(this),"date"!==this.inputType||this.format||(this.format="c"),this._inputType="number"===this.inputType?"text":this.inputType,this.parent(arguments).mixin("validation");var t=n(this);t.val_initial=this.value},registerEvents:function(){this.parent(arguments).mixin("validation",arguments)},watchStart:function(){null===this._iid&&(this._iid=setInterval(this.handleChange_,this.watchInterval),this.handleChange())},watchStop:function(){null!==this._iid&&(clearInterval(this._iid),this._iid=null,this.handleChange())}}}()),t.define(j("Error"),function(){return{constructor:function(t){T(t)||(t=I(t)?{message:t}:{}),B.copy(this,t),this.trace().parent()},extend:Error,module:V,name:y(e)+"Error",toString:function(){return this.message},trace:Error.caputureStackTrace?function(){switch(B.ntype(this.method)){case"string":if(!this.cmp||!S(this.cmp[this.method]))break;this.method=this.cmp[this.method];case"function":Error.captureStackTrace(this,this.method)}}:B.noop}}()),L.code={BOX_ITEM_LOOKUP:"BoxItemLookupError"},!function(){if("browser"==B.ENV){var t=["blur","focus","resize","click","dblclick","change","select","submit","keydown","keypress","keyup","animationend","animationiteration","animationstart","transitionend"],e=["orientationchange","resize"];k.desktop&&t.push("mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup"),t.map(function(t){this.on(t,"[data-"+t+"]",h)},N.$(M)),e.map(function(t){this.on(t,"[data-"+t+"]",l)},N.$(P).on("scroll","[data-scroll]",h))}}(),N.$.ready(function(){var t=r(j("Box"),{$_items:"$el",clsBase:"w-viewport",$ct:N.$(M.documentElement),ct:M.documentElement,id:"viewport"});t.$el=N.$(t.el=M.body),t.rendered=!0,t.$el.addClass(t.clsBase).attr("id",t.id),B.def(V,"Viewport",{value:t},"cw"),t.broadcast("viewport:ready")})}("undefined"!=typeof id8?id8:"undefined"!=typeof require?require("id8"):null,"widgie");